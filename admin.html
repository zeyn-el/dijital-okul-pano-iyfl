<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - Okul Dijital Pano</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&family=Material+Symbols+Outlined:wght@100..700&display=swap"
    rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            "primary": "#2b8cee",
            "primary-dark": "#1e6bb8",
          },
          fontFamily: {
            "display": ["Lexend", "sans-serif"]
          }
        }
      }
    }
  </script>
  <style>
    body {
      font-family: 'Lexend', sans-serif;
    }

    .card-admin {
      background: white;
      border-radius: 1rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border: 1px solid #e5e7eb;
      transition: all 0.3s ease;
    }

    .card-admin:hover {
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      transform: translateY(-2px);
    }

    .card-admin h2 {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: #1f2937;
      border-bottom: 2px solid #2b8cee;
      padding-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .input-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 600;
      color: #374151;
      margin-bottom: 0.5rem;
    }

    .input-field {
      width: 100%;
      border: 2px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 0.75rem;
      font-size: 0.875rem;
      transition: all 0.2s ease;
      font-family: 'Lexend', sans-serif;
    }

    .input-field:focus {
      outline: none;
      border-color: #2b8cee;
      box-shadow: 0 0 0 3px rgba(43, 140, 238, 0.1);
    }

    .input-field::placeholder {
      color: #9ca3af;
    }

    .btn-save {
      margin-top: 1rem;
      padding: 0.75rem 1.5rem;
      background: linear-gradient(135deg, #2b8cee 0%, #1e6bb8 100%);
      color: white;
      border-radius: 0.5rem;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px -1px rgba(43, 140, 238, 0.3);
    }

    .btn-save:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(43, 140, 238, 0.4);
    }

    .btn-save:active {
      transform: translateY(0);
    }

    .btn-back {
      padding: 0.75rem 2rem;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      border-radius: 0.5rem;
      font-weight: 600;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.3);
    }

    .btn-back:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.4);
    }

    .helper-text {
      font-size: 0.75rem;
      color: #6b7280;
      margin-top: 0.25rem;
      font-style: italic;
    }

    .tab-button {
      padding: 0.75rem 1.5rem;
      border-bottom: 3px solid transparent;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      color: #6b7280;
      white-space: nowrap;
    }

    .tab-button.active {
      color: #2b8cee;
      border-bottom-color: #2b8cee;
    }

    .tab-button:hover {
      color: #2b8cee;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .schedule-entry {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 0.75rem;
    }

    /* Media Center Styles */
    .media-type-btn {
      text-align: center;
      border-color: #e5e7eb;
      background: white;
    }

    .media-type-btn:hover {
      border-color: #2b8cee;
      background: #f0f7ff;
    }

    .media-type-btn.active {
      border-color: #2b8cee;
      background: #e7f3ff;
      color: #2b8cee;
    }

    .media-settings {
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

  <!-- Firebase Configuration -->
  <script src="firebase-config.js"></script>

  <script>
    // Firebase-based data loading and saving
    async function loadData() {
      return await FirebaseStorage.loadData();
    }

    // Async wrapper for saveData (waits for Firebase to complete)
    async function saveData(x) {
      try {
        await FirebaseStorage.saveData(x);
        console.log('âœ… Veriler Firebase\'e kaydedildi');
        return true;
      } catch (err) {
        console.error('âŒ Firebase kaydetme hatasÄ±:', err);
        return false;
      }
    }

    let data = {};

    // Initialize data on page load
    async function initializeData() {
      console.log('ğŸ”„ initializeData baÅŸladÄ±...');
      data = await loadData();
      console.log('ğŸ“¥ Firebase\'den yÃ¼klenen data:', data);
      console.log('ğŸ“¥ data.cards var mÄ±?', !!data?.cards);

      // EÄŸer veri hiÃ§ yoksa veya bozuksa varsayÄ±lan yapÄ±yÄ± oluÅŸtur
      if (!data || !data.cards) {
        data = {
          schoolName: "OKUL ADI GÄ°RÄ°NÄ°Z",
          cards: {
            birthdays: {
              enabled: true,
              title: "Ä°yi ki doÄŸdun!",
              students: []
            },
            duty: {
              list: []
            },
            dutyByDate: {
              items: []
            },
            yks: {
              enabled: true,
              title: "YKS'ye Kalan",
              date: ""
            },
            info: {
              enabled: true,
              items: [],
              sliderSpeed: 5
            },
            mediaCenter: {
              type: "slideshow",
              fullscreen: false,
              slideshow: { images: [], speed: 5 },
              video: { url: "", autoplay: false, loop: false, muted: false },
              webpage: { url: "" }
            },
            quotes: {
              title: "GÃ¼nÃ¼n SÃ¶zÃ¼",
              items: [],
              enableSlider: false,
              sliderSpeed: 8,
              maxSlides: 5
            },
            ticker: {
              text: "",
              speed: 20
            },
            schedule: {
              items: []
            },
            timePlan: {
              items: []
            }
          }
        };
      } else {
        // Firebase'den veri geldi ama bazÄ± alanlar eksik olabilir, onlarÄ± ekle
        if (!data.cards.birthdays) {
          data.cards.birthdays = { enabled: true, title: "Ä°yi ki doÄŸdun!", students: [] };
        }
        if (!data.cards.dutyByDate) {
          data.cards.dutyByDate = { items: [] };
        }
        if (!data.cards.quotes) {
          data.cards.quotes = { title: "GÃ¼nÃ¼n SÃ¶zÃ¼", items: [], enableSlider: false, sliderSpeed: 8, maxSlides: 5 };
        }
        if (!data.cards.info) {
          data.cards.info = { enabled: true, items: [], sliderSpeed: 5 };
        }
        if (!data.cards.duty) {
          data.cards.duty = { list: [] };
        }
        if (!data.cards.yks) {
          data.cards.yks = { enabled: true, title: "YKS'ye Kalan", date: "" };
        }
        if (!data.cards.mediaCenter) {
          data.cards.mediaCenter = { type: "slideshow", fullscreen: false, slideshow: { images: [], speed: 5 }, video: { url: "", autoplay: false, loop: false, muted: false }, webpage: { url: "" } };
        }
        if (!data.cards.ticker) {
          data.cards.ticker = { text: "", speed: 20 };
        }
        if (!data.cards.schedule) {
          data.cards.schedule = { items: [] };
        }
        if (!data.cards.timePlan) {
          data.cards.timePlan = { items: [] };
        }
      }

      console.log('âœ… initializeData tamamlandÄ±. Final data:', data);
      console.log('âœ… Final data.cards:', data.cards);
      console.log('âœ… data.cards.dutyByDate:', data.cards.dutyByDate);
      console.log('âœ… data.cards.birthdays:', data.cards.birthdays);
      console.log('âœ… data.cards.quotes:', data.cards.quotes);
    }

    // Tab switching
    function showTab(tabName) {
      const tabs = document.querySelectorAll('.tab-content');
      const buttons = document.querySelectorAll('.tab-button');

      tabs.forEach(tab => tab.classList.remove('active'));
      buttons.forEach(btn => btn.classList.remove('active'));

      document.getElementById(tabName).classList.add('active');
      // event.target might be undefined if called manually, so check it
      if (event && event.target) {
        event.target.classList.add('active');
      } else {
        // If called manually, find the button that calls this tab
        const activeBtn = Array.from(buttons).find(b => b.getAttribute('onclick').includes(tabName));
        if (activeBtn) activeBtn.classList.add('active');
      }
    }
  </script>
</head>

<body class="bg-gradient-to-br from-slate-50 via-blue-50 to-slate-100 min-h-screen">

  <!-- GiriÅŸ KontrolÃ¼ -->
  <script>
    // Sayfa yÃ¼klendiÄŸinde giriÅŸ kontrolÃ¼ yap
    (function () {
      const session = sessionStorage.getItem('adminSession');
      if (!session) {
        // GiriÅŸ yapÄ±lmamÄ±ÅŸ, login sayfasÄ±na yÃ¶nlendir
        window.location.href = 'login.html';
      }
    })();

    // Ã‡Ä±kÄ±ÅŸ fonksiyonu
    function logout() {
      if (confirm('Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinizden emin misiniz?')) {
        sessionStorage.removeItem('adminSession');
        window.location.href = 'login.html';
      }
    }

    // KullanÄ±cÄ± bilgilerini gÃ¶ster
    function displayUserInfo() {
      const session = sessionStorage.getItem('adminSession');
      if (session) {
        const user = JSON.parse(session);
        const userInfoElement = document.getElementById('userInfo');
        if (userInfoElement) {
          userInfoElement.textContent = `${user.username} (${user.role})`;
        }
      }
    }
  </script>

  <div class="container mx-auto px-4 py-8 max-w-6xl">

    <!-- Header -->
    <header class="mb-10 text-center">
      <div
        class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-primary to-primary-dark rounded-2xl mb-4 shadow-lg">
        <span class="material-symbols-outlined text-white text-5xl">settings</span>
      </div>
      <h1 class="text-5xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-2">Admin
        Panel</h1>
      <p class="text-gray-600 text-lg">Dijital Pano Ä°Ã§eriklerini YÃ¶netin</p>

      <!-- KullanÄ±cÄ± Bilgisi ve Ã‡Ä±kÄ±ÅŸ -->
      <div class="mt-4 flex items-center justify-center gap-4">
        <div class="flex items-center gap-2 bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-200">
          <span class="material-symbols-outlined text-primary">person</span>
          <span id="userInfo" class="font-semibold text-gray-700">KullanÄ±cÄ±</span>
        </div>
        <button onclick="logout()"
          class="flex items-center gap-2 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors shadow-sm">
          <span class="material-symbols-outlined">logout</span>
          Ã‡Ä±kÄ±ÅŸ Yap
        </button>
      </div>

      <div class="mt-6 flex justify-center gap-4">
        <a href="index.html" class="btn-back">
          <span class="material-symbols-outlined">arrow_back</span>
          Pano'ya DÃ¶n
        </a>
        <a href="user-management.html"
          class="inline-flex items-center gap-2 bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 transition-colors shadow-sm font-semibold">
          <span class="material-symbols-outlined">manage_accounts</span>
          KullanÄ±cÄ± YÃ¶netimi
        </a>
      </div>
    </header>

    <!-- Tabs -->
    <div class="bg-white rounded-t-2xl shadow-md border-b border-gray-200 flex flex-wrap gap-2 px-4 py-2">
      <button class="tab-button active" onclick="showTab('tab-general')">ğŸ« Genel</button>
      <button class="tab-button" onclick="showTab('tab-cards')">â³ YKS SayaÃ§</button>
      <button class="tab-button" onclick="showTab('tab-info')">ğŸ† Bilgi</button>
      <button class="tab-button" onclick="showTab('tab-duty')">ğŸ‘® NÃ¶betÃ§i Ã–ÄŸretmenler</button>
      <button class="tab-button" onclick="showTab('tab-birthdays')">ğŸ‚ DoÄŸum GÃ¼nleri</button>
      <button class="tab-button" onclick="showTab('tab-quotes')">ğŸ’¬ GÃ¼nÃ¼n SÃ¶zÃ¼</button>
      <button class="tab-button" onclick="showTab('tab-media')">ğŸ¬ Medya Merkezi</button>
      <a href="schedule-management.html" class="tab-button flex items-center gap-1">
        ğŸ“š Ders ProgramÄ±
        <span class="material-symbols-outlined text-sm">open_in_new</span>
      </a>
    </div>

    <!-- Tab Contents -->
    <div class="bg-white rounded-b-2xl shadow-md p-6 mb-6">

      <!-- TAB: GENEL -->
      <div id="tab-general" class="tab-content active">

        <!-- OKUL ADI -->
        <div class="card-admin">
          <h2>ğŸ« Okul AdÄ±</h2>
          <div class="mb-4">
            <label class="input-label">Okul AdÄ±</label>
            <input id="schoolName" type="text" class="input-field" placeholder="Ã–rn: Ä°smet YÄ±lmaz Fen Lisesi">
          </div>
          <button onclick="saveSchoolName()" class="btn-save">ğŸ’¾ Kaydet</button>
        </div>

        <!-- KAYAN YAZI (TICKER) -->
        <div class="card-admin">
          <h2>ğŸ“¢ Alt Kayan YazÄ±</h2>
          <div class="mb-4">
            <label class="input-label">Duyuru Metni</label>
            <textarea id="tText" rows="4" class="input-field"
              placeholder="ğŸ“¢ ToplantÄ± ertelendi. â€¢ ğŸ† Voleybol takÄ±mÄ± finale Ã§Ä±ktÄ±."></textarea>
            <p class="helper-text">Birden fazla duyuru iÃ§in â€¢ iÅŸareti kullanÄ±n</p>
          </div>
          <div class="mb-4">
            <label class="input-label">Kayan YazÄ± HÄ±zÄ±</label>
            <div class="flex items-center gap-4">
              <span class="text-sm text-gray-600 font-medium">HÄ±zlÄ±</span>
              <input id="tSpeed" type="range" min="5" max="60" value="20" step="1"
                class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary"
                oninput="updateTickerSpeedLabel()">
              <span class="text-sm text-gray-600 font-medium">YavaÅŸ</span>
            </div>
            <p class="helper-text mt-2">
              SÃ¼re: <span id="tSpeedLabel" class="font-bold text-primary">20</span> saniye
              <span class="text-xs text-gray-400">(DÃ¼ÅŸÃ¼k deÄŸer = HÄ±zlÄ±, YÃ¼ksek deÄŸer = YavaÅŸ)</span>
            </p>
          </div>
          <button onclick="saveTicker()" class="btn-save">ğŸ’¾ Kaydet</button>
        </div>
        <!-- FÄ°REBASE VERÄ° AKTARIMI -->
        <div class="card-admin border-l-4 border-l-orange-500">
          <h2>ğŸ”¥ Firebase Veri AktarÄ±mÄ±</h2>
          <p class="text-gray-600 text-sm mb-4">
            LocalStorage'daki tÃ¼m verilerinizi Firebase'e manuel olarak aktarabilirsiniz.
            <br><span class="text-orange-600 font-bold">NOT:</span> Bu iÅŸlem Firebase'deki mevcut verilerin Ã¼zerine
            yazacaktÄ±r.
          </p>

          <div id="migrationStatus" class="mb-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
            <p class="text-sm text-gray-600">
              <span class="font-bold">Durum:</span>
              <span id="migrationStatusText">HazÄ±r</span>
            </p>
          </div>

          <div class="flex gap-2">
            <button onclick="migrateToFirebase()" class="btn-save bg-orange-600 hover:bg-orange-700">
              ğŸš€ LocalStorage Verilerini Firebase'e Aktar
            </button>
            <button onclick="checkFirebaseData()" class="btn-save bg-blue-600 hover:bg-blue-700">
              ğŸ” Firebase Verilerini Kontrol Et
            </button>
          </div>
        </div>
        <!-- HAM VERÄ° GÃ–RÃœNTÃœLEME VE DÃœZENLEME -->
        <div class="card-admin border-l-4 border-l-purple-500">
          <h2>ğŸ› ï¸ GeliÅŸmiÅŸ Veri YÃ¶netimi (Yedek/JSON)</h2>
          <p class="text-gray-600 text-sm mb-4">
            Buradan tÃ¼m verileri JSON formatÄ±nda gÃ¶rÃ¼ntÃ¼leyebilir, dÃ¼zenleyebilir veya bir yedeÄŸi yapÄ±ÅŸtÄ±rÄ±p geri
            yÃ¼kleyebilirsiniz.
            <br><span class="text-red-500 font-bold">DÄ°KKAT:</span> HatalÄ± JSON formatÄ± girerseniz verileriniz
            bozulabilir.
          </p>
          <div class="mb-4">
            <label class="input-label">Ham Veri (JSON)</label>
            <textarea id="rawDataOutput" rows="12"
              class="input-field font-mono text-xs bg-slate-900 text-green-400"></textarea>
          </div>
          <div class="flex gap-2">
            <button onclick="showRawData()" class="btn-save bg-slate-600 hover:bg-slate-700">ğŸ“ Verileri Getir</button>
            <button onclick="importRawData()" class="btn-save bg-purple-600 hover:bg-purple-700">ğŸ’¾ JSON Verisini Ä°Ã§e
              Aktar / Kaydet</button>
          </div>
        </div>

      </div>

      <!-- TAB: YKS SAYAÃ‡ -->
      <div id="tab-cards" class="tab-content">

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

          <!-- YKS GERÄ° SAYIM -->
          <div class="card-admin">
            <h2>â³ YKS Geri SayÄ±m</h2>

            <!-- GÃ¶rÃ¼nÃ¼rlÃ¼k AyarÄ± -->
            <div class="mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="yksEnabled" class="w-5 h-5 accent-primary cursor-pointer">
                <span class="font-medium">YKS sayaÃ§ kartÄ±nÄ± ana panoda gÃ¶ster</span>
              </label>
              <p class="helper-text mt-2">Bu seÃ§enek iÅŸaretli deÄŸilse kart gizlenir.</p>
            </div>

            <!-- BaÅŸlÄ±k DÃ¼zenleme -->
            <div class="mb-4">
              <label class="input-label">Kart BaÅŸlÄ±ÄŸÄ±</label>
              <input id="yksTitle" type="text" class="input-field"
                placeholder="Ã–rn: YKS'ye Kalan, TYT'ye Kalan, AYT'ye Kalan">
              <p class="helper-text">SÄ±nav adÄ± deÄŸiÅŸirse buradan gÃ¼ncelleyebilirsiniz</p>
            </div>

            <div class="mb-4">
              <label class="input-label">SÄ±nav Tarihi</label>
              <input id="yksDate" type="date" class="input-field">
            </div>
            <button onclick="saveYKS()" class="btn-save">ğŸ’¾ Kaydet</button>
          </div>



        </div>


      </div>

      <!-- TAB: BÄ°LGÄ° KARTI -->
      <div id="tab-info" class="tab-content">

        <div class="card-admin">
          <div class="flex items-center justify-between mb-6">
            <h2 class="flex items-center gap-2">
              <span class="material-symbols-outlined text-3xl text-green-600">emoji_events</span>
              ğŸ† Bilgi KartÄ± YÃ¶netimi
            </h2>
            <button onclick="saveInfoData()"
              class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-1 transition-colors shadow-sm">
              <span class="material-symbols-outlined text-lg">save</span>
              Kaydet
            </button>
          </div>

          <p class="text-gray-600 mb-6">
            TeÅŸvik edici bilgiler ekleyin. HaftanÄ±n enleri, geliÅŸme gÃ¶sterenler gibi baÅŸarÄ±larÄ± paylaÅŸÄ±n.
          </p>

          <!-- GÃ¶rÃ¼nÃ¼rlÃ¼k AyarÄ± -->
          <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" id="infoEnabled" class="w-5 h-5 accent-primary cursor-pointer">
              <span class="font-medium">Bilgi kartÄ±nÄ± ana panoda gÃ¶ster</span>
            </label>
            <p class="helper-text mt-2">Bu seÃ§enek iÅŸaretli deÄŸilse kart gizlenir.</p>
          </div>

          <!-- Kart Rengi SeÃ§imi -->
          <div class="mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200">
            <label class="input-label flex items-center gap-2 mb-3">
              <span class="material-symbols-outlined text-purple-600">palette</span>
              Kart Arka Plan Rengi
            </label>

            <div class="grid grid-cols-4 sm:grid-cols-6 gap-2 mb-4">
              <!-- Preset Colors -->
              <button type="button" onclick="setInfoCardColor('#2b8cee')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: #2b8cee;" title="Mavi (VarsayÄ±lan)"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #667eea 0%, #764ba2 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" title="Mor Gradyan"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #f093fb 0%, #f5576c 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" title="Pembe Gradyan"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"
                title="AÃ§Ä±k Mavi Gradyan"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);" title="YeÅŸil Gradyan"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #fa709a 0%, #fee140 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);" title="Turuncu-Pembe"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);" title="Pastel"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);" title="Pembe Pastel"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);" title="Ä°ndigo"></button>
              <button type="button" onclick="setInfoCardColor('linear-gradient(135deg, #0f172a 0%, #1e293b 100%)')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);" title="Koyu"></button>
              <button type="button" onclick="setInfoCardColor('#dc2626')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: #dc2626;" title="KÄ±rmÄ±zÄ±"></button>
              <button type="button" onclick="setInfoCardColor('#059669')"
                class="info-color-btn w-full h-10 rounded-lg border-2 border-transparent hover:border-gray-400 transition-all"
                style="background: #059669;" title="Koyu YeÅŸil"></button>
            </div>

            <div class="flex items-center gap-3">
              <label class="text-sm font-medium text-gray-600">Ã–zel Renk:</label>
              <input type="text" id="infoCardColorInput" class="input-field flex-1 text-sm"
                placeholder="#2b8cee veya linear-gradient(...)" onchange="setInfoCardColor(this.value)">
              <div id="infoCardColorPreview" class="w-10 h-10 rounded-lg border border-gray-300 flex-shrink-0"
                style="background: #2b8cee;"></div>
            </div>
            <p class="helper-text mt-2">HazÄ±r renklerden birini seÃ§in veya Ã¶zel renk/gradyan girin.</p>
          </div>

          <!-- Manuel Bilgi Ekleme -->
          <div class="mb-6 p-4 bg-slate-50 rounded-xl border border-slate-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-primary">add_circle</span>
              Yeni Bilgi Ekle
            </h3>

            <div id="infoEntriesContainer" class="space-y-4">
              <!-- Ä°lk form JS ile eklenecek -->
            </div>

            <button onclick="addInfoEntryRow()"
              class="mt-4 w-full py-2 border-2 border-dashed border-green-500/30 text-green-600 font-bold rounded-lg hover:bg-green-50 transition-colors flex items-center justify-center gap-1">
              <span class="material-symbols-outlined">add</span>
              + Yeni Bilgi Ekle
            </button>
          </div>

          <!-- Slayt AyarlarÄ± -->
          <div class="mb-6 p-4 bg-purple-50 rounded-xl border border-purple-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-purple-600">settings</span>
              Slayt AyarlarÄ±
            </h3>

            <div class="mb-4">
              <label class="input-label text-sm">Slayt GeÃ§iÅŸ HÄ±zÄ± (saniye)</label>
              <input id="infoSliderSpeed" type="number" min="3" max="30" value="5"
                class="input-field p-2 text-sm w-full">
              <p class="helper-text text-xs">Birden fazla bilgi varsa slaytlar arasÄ± geÃ§iÅŸ sÃ¼resi</p>
            </div>
          </div>

          <!-- Bilgi Listesi Tablosu -->
          <div class="mb-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-bold text-lg flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">list</span>
                Bilgi Listesi
                <span id="infoCount" class="text-sm font-normal text-gray-500">(0 kayÄ±t)</span>
              </h3>
              <button onclick="clearAllInfos()"
                class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-bold">
                <span class="material-symbols-outlined text-sm mr-1">delete_sweep</span>
                TÃ¼mÃ¼nÃ¼ Temizle
              </button>
            </div>

            <div class="overflow-x-auto rounded-lg border border-slate-200">
              <table class="w-full text-left border-collapse text-sm">
                <thead>
                  <tr class="bg-slate-50 text-slate-600 uppercase tracking-wider">
                    <th class="p-3 border-b border-slate-200">#</th>
                    <th class="p-3 border-b border-slate-200">BaÅŸlÄ±k</th>
                    <th class="p-3 border-b border-slate-200">Detay</th>
                    <th class="p-3 border-b border-slate-200">Not</th>
                    <th class="p-3 border-b border-slate-200 text-right">Ä°ÅŸlem</th>
                  </tr>
                </thead>
                <tbody id="infoTableBody">
                  <!-- JS ile doldurulacak -->
                </tbody>
              </table>
            </div>

            <div id="emptyInfoMsg" class="hidden p-8 text-center text-slate-400 italic">
              HenÃ¼z bilgi kaydÄ± bulunmuyor.
            </div>
          </div>

          <!-- Kaydet Butonu -->
          <div class="flex justify-end gap-3">
            <button onclick="saveInfoData()" class="btn-save">
              ğŸ’¾ TÃ¼m DeÄŸiÅŸiklikleri Kaydet
            </button>
          </div>

        </div>

      </div>

      <!-- TAB: NÃ–BETÃ‡Ä° Ã–ÄRETMENLER -->
      <div id="tab-duty" class="tab-content">

        <div class="card-admin">
          <div class="flex items-center justify-between mb-6">
            <h2 class="flex items-center gap-2">
              <span class="material-symbols-outlined text-3xl text-blue-500">badge</span>
              ğŸ‘® NÃ¶betÃ§i Ã–ÄŸretmen YÃ¶netimi
            </h2>
            <button onclick="saveDutyData()"
              class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-1 transition-colors shadow-sm">
              <span class="material-symbols-outlined text-lg">save</span>
              Kaydet
            </button>
          </div>

          <p class="text-gray-600 mb-6">
            NÃ¶betÃ§i Ã¶ÄŸretmenleri yÃ¶netin. Her tarih iÃ§in birden fazla yer ve Ã¶ÄŸretmen ekleyebilirsiniz.
          </p>

          <!-- Manuel NÃ¶betÃ§i Ekleme -->
          <div class="mb-6 p-4 bg-slate-50 rounded-xl border border-slate-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-primary">add_circle</span>
              Manuel NÃ¶betÃ§i Ekle
            </h3>

            <div id="dutyEntriesContainer" class="space-y-4">
              <!-- Ä°lk satÄ±r JS ile eklenecek -->
            </div>

            <button onclick="addDutyEntryRow()"
              class="mt-4 w-full py-2 border-2 border-dashed border-primary/30 text-primary font-bold rounded-lg hover:bg-primary/5 transition-colors flex items-center justify-center gap-1">
              <span class="material-symbols-outlined">add</span>
              + Yeni KayÄ±t
            </button>
          </div>

          <!-- Toplu Ä°Ã§e Aktarma -->
          <div class="mb-6 p-4 bg-green-50 rounded-xl border border-green-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-green-600">upload_file</span>
              Toplu NÃ¶betÃ§i Ä°Ã§e Aktarma
            </h3>

            <div class="mb-4">
              <label class="input-label text-sm">Toplu NÃ¶betÃ§i Verisi (CSV Format)</label>
              <textarea id="bulkDutyData" rows="8" class="input-field p-3 text-sm font-mono" placeholder="Tarih,GÃ¼n,YerAdÄ±,Ã–ÄŸretmenAdÄ±
2025-12-15,Pazar,Zemin Kat,Ahmet YÄ±lmaz
2025-12-15,Pazar,1. Kat,AyÅŸe Demir
2025-12-16,Pazartesi,BahÃ§e,Mehmet Kaya
2025-12-16,Pazartesi,2. Kat,Zeynep Ã‡elik"></textarea>
              <p class="helper-text">
                ğŸ’¡ Format: Tarih,GÃ¼n,YerAdÄ±,Ã–ÄŸretmenAdÄ±<br>
                Excel'den veya metin dosyasÄ±ndan kopyala-yapÄ±ÅŸtÄ±r yapabilirsiniz.<br>
                Ä°lk satÄ±r baÅŸlÄ±k olmalÄ±. Tarih formatÄ±: YYYY-MM-DD (Ã–rn: 2025-12-15)<br>
                <span class="text-amber-600 font-semibold">Not:</span> GÃ¼n alanÄ± opsiyoneldir, boÅŸ bÄ±rakÄ±lÄ±rsa otomatik
                hesaplanÄ±r.
              </p>
            </div>

            <button onclick="importBulkDuties()" class="btn-save bg-green-600 hover:bg-green-700">
              <span class="material-symbols-outlined text-sm mr-1">cloud_upload</span>
              Toplu Ä°Ã§e Aktar
            </button>
          </div>

          <!-- NÃ¶betÃ§i Listesi Tablosu -->
          <div class="mb-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-bold text-lg flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">list</span>
                NÃ¶betÃ§i Listesi
                <span id="dutyCount" class="text-sm font-normal text-gray-500">(0 kayÄ±t)</span>
              </h3>
              <div class="flex gap-2">
                <button onclick="initDutyData()"
                  class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-bold flex items-center gap-1">
                  <span class="material-symbols-outlined text-sm">refresh</span>
                  Listeyi Yenile
                </button>
                <button onclick="clearAllDuties()"
                  class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-bold">
                  <span class="material-symbols-outlined text-sm mr-1">delete_sweep</span>
                  TÃ¼mÃ¼nÃ¼ Temizle
                </button>
              </div>
            </div>

            <div class="overflow-x-auto rounded-lg border border-slate-200">
              <table class="w-full text-left border-collapse text-sm">
                <thead>
                  <tr class="bg-slate-50 text-slate-600 uppercase tracking-wider">
                    <th class="p-3 border-b border-slate-200">#</th>
                    <th class="p-3 border-b border-slate-200">Tarih</th>
                    <th class="p-3 border-b border-slate-200">GÃ¼n</th>
                    <th class="p-3 border-b border-slate-200">Yer</th>
                    <th class="p-3 border-b border-slate-200">Ã–ÄŸretmen AdÄ±</th>
                    <th class="p-3 border-b border-slate-200 text-right">Ä°ÅŸlem</th>
                  </tr>
                </thead>
                <tbody id="dutyTableBody">
                  <!-- JS ile doldurulacak -->
                </tbody>
              </table>
            </div>

            <div id="emptyDutyMsg" class="hidden p-8 text-center text-slate-400 italic">
              HenÃ¼z nÃ¶betÃ§i kaydÄ± bulunmuyor.
            </div>
          </div>

          <!-- Kaydet Butonu -->
          <div class="flex justify-end gap-3">
            <button onclick="saveDutyData()" class="btn-save">
              ğŸ’¾ TÃ¼m DeÄŸiÅŸiklikleri Kaydet
            </button>
          </div>

        </div>

      </div>

      <!-- TAB: DOÄUM GÃœNLERÄ° -->
      <div id="tab-birthdays" class="tab-content">

        <div class="card-admin">
          <div class="flex items-center justify-between mb-6">
            <h2 class="flex items-center gap-2">
              <span class="material-symbols-outlined text-3xl text-pink-500">cake</span>
              ğŸ‚ DoÄŸum GÃ¼nÃ¼ YÃ¶netimi
            </h2>
            <div class="flex items-center gap-2">
              <button onclick="saveBirthdayData()"
                class="bg-pink-600 hover:bg-pink-700 text-white px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-1 transition-colors shadow-sm">
                <span class="material-symbols-outlined text-lg">save</span>
                Kaydet
              </button>
              <!-- Debug Butonu -->
              <button onclick="openBirthdayDebugModal()"
                class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm font-bold flex items-center gap-2">
                <span class="material-symbols-outlined text-sm">bug_report</span>
                Debug
              </button>
            </div>
          </div>

          <p class="text-gray-600 mb-6">
            Ã–ÄŸrenci doÄŸum gÃ¼nlerini yÃ¶netin. Manuel olarak ekleyebilir veya Excel'den toplu olarak iÃ§e aktarabilirsiniz.
          </p>

          <!-- GÃ¶rÃ¼nÃ¼rlÃ¼k AyarÄ± -->
          <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" id="birthdayEnabled" class="w-5 h-5 accent-primary cursor-pointer">
              <span class="font-medium">DoÄŸum gÃ¼nÃ¼ kartÄ±nÄ± ana panoda gÃ¶ster</span>
            </label>
            <p class="helper-text mt-2">Bu seÃ§enek iÅŸaretli deÄŸilse kart gizlenir.</p>
          </div>

          <!-- Kart BaÅŸlÄ±ÄŸÄ± -->
          <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <label class="input-label">Kart BaÅŸlÄ±ÄŸÄ±</label>
            <input id="bTitle" type="text" class="input-field" placeholder="Ã–rn: Ä°yi ki doÄŸdun!">
            <p class="helper-text">Ana panoda gÃ¶sterilecek baÅŸlÄ±k</p>
          </div>

          <!-- Manuel GiriÅŸ BÃ¶lÃ¼mÃ¼ -->
          <div class="mb-6 p-4 bg-slate-50 rounded-xl border border-slate-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-primary">person_add</span>
              Manuel Ã–ÄŸrenci Ekle
            </h3>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
              <div>
                <label class="input-label text-sm">Ad</label>
                <input id="manualName" type="text" class="input-field p-2 text-sm" placeholder="Ã–rn: Ahmet">
              </div>
              <div>
                <label class="input-label text-sm">Soyad</label>
                <input id="manualSurname" type="text" class="input-field p-2 text-sm" placeholder="Ã–rn: YÄ±lmaz">
              </div>
              <div>
                <label class="input-label text-sm">Cinsiyet</label>
                <select id="manualGender" class="input-field p-2 text-sm bg-white">
                  <option value="E">Erkek</option>
                  <option value="K">KÄ±z</option>
                </select>
              </div>
              <div>
                <label class="input-label text-sm">DoÄŸum Tarihi</label>
                <input id="manualBirthdate" type="date" class="input-field p-2 text-sm">
              </div>
            </div>

            <div class="mb-4">
              <label class="input-label text-sm">Not (Opsiyonel)</label>
              <input id="manualNote" type="text" class="input-field p-2 text-sm" placeholder="Ã–rn: 9-A sÄ±nÄ±fÄ±">
            </div>

            <button onclick="addManualBirthday()" class="btn-save">
              <span class="material-symbols-outlined text-sm mr-1">add</span>
              Ã–ÄŸrenci Ekle
            </button>
          </div>

          <!-- Excel Ä°Ã§e Aktarma -->
          <div class="mb-6 p-4 bg-green-50 rounded-xl border border-green-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-green-600">upload_file</span>
              Excel'den Toplu Ä°Ã§e Aktar
            </h3>

            <div class="mb-4">
              <label class="input-label text-sm">Excel Verisi (CSV Format)</label>
              <textarea id="excelData" rows="6" class="input-field p-3 text-sm font-mono" placeholder="Ad,Soyad,Cinsiyet,DoÄŸumTarihi,Not
Ahmet,YÄ±lmaz,E,2010-05-15,9-A
AyÅŸe,Demir,K,2010-08-22,9-B
Mehmet,Kaya,E,2009-12-10,10-A"></textarea>
              <p class="helper-text">
                ğŸ’¡ Format: Ad,Soyad,Cinsiyet(E/K),DoÄŸumTarihi(YYYY-MM-DD),Not<br>
                Excel'den kopyala-yapÄ±ÅŸtÄ±r yapabilirsiniz. Ä°lk satÄ±r baÅŸlÄ±k olmalÄ±.
              </p>
            </div>

            <button onclick="importFromExcel()" class="btn-save bg-green-600 hover:bg-green-700">
              <span class="material-symbols-outlined text-sm mr-1">cloud_upload</span>
              Excel Verisini Ä°Ã§e Aktar
            </button>
          </div>

          <!-- Filtreleme ve GÃ¶rÃ¼ntÃ¼leme SeÃ§enekleri -->
          <div class="mb-6 p-4 bg-purple-50 rounded-xl border border-purple-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-purple-600">filter_list</span>
              GÃ¶rÃ¼ntÃ¼leme SeÃ§enekleri
            </h3>

            <div class="flex items-center gap-4">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="showAllBirthdays" class="w-5 h-5 accent-primary cursor-pointer"
                  onchange="toggleBirthdayFilter()">
                <span class="font-medium">TÃ¼m Ã¶ÄŸrencileri gÃ¶ster (tarihe gÃ¶re sÄ±ralÄ±)</span>
              </label>
              <span class="text-sm text-gray-500">
                (Ä°ÅŸaretli deÄŸilse sadece bugÃ¼n doÄŸum gÃ¼nÃ¼ olanlar gÃ¶sterilir)
              </span>
            </div>
          </div>

          <!-- Ã–ÄŸrenci Listesi Tablosu -->
          <div class="mb-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-bold text-lg flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">list</span>
                Ã–ÄŸrenci Listesi
                <span id="studentCount" class="text-sm font-normal text-gray-500">(0 Ã¶ÄŸrenci)</span>
              </h3>
              <div class="flex gap-2">
                <button onclick="initBirthdayData()"
                  class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-bold flex items-center gap-1">
                  <span class="material-symbols-outlined text-sm">refresh</span>
                  Listeyi Yenile
                </button>
                <button onclick="clearAllBirthdays()"
                  class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-bold">
                  <span class="material-symbols-outlined text-sm mr-1">delete_sweep</span>
                  TÃ¼mÃ¼nÃ¼ Temizle
                </button>
              </div>
            </div>

            <div class="overflow-x-auto rounded-lg border border-slate-200">
              <table class="w-full text-left border-collapse text-sm">
                <thead>
                  <tr class="bg-slate-50 text-slate-600 uppercase tracking-wider">
                    <th class="p-3 border-b border-slate-200">#</th>
                    <th class="p-3 border-b border-slate-200">Ad Soyad</th>
                    <th class="p-3 border-b border-slate-200">Cinsiyet</th>
                    <th class="p-3 border-b border-slate-200">DoÄŸum Tarihi</th>
                    <th class="p-3 border-b border-slate-200">YaÅŸ</th>
                    <th class="p-3 border-b border-slate-200">Not</th>
                    <th class="p-3 border-b border-slate-200 text-right">Ä°ÅŸlem</th>
                  </tr>
                </thead>
                <tbody id="birthdayTableBody">
                  <!-- JS ile doldurulacak -->
                </tbody>
              </table>
            </div>

            <div id="emptyBirthdayMsg" class="hidden p-8 text-center text-slate-400 italic">
              HenÃ¼z Ã¶ÄŸrenci kaydÄ± bulunmuyor.
            </div>
          </div>

          <!-- Kaydet Butonu -->
          <div class="flex justify-end gap-3">
            <button onclick="saveBirthdayData()" class="btn-save">
              ğŸ’¾ TÃ¼m DeÄŸiÅŸiklikleri Kaydet
            </button>
          </div>

        </div>

      </div>

      <!-- TAB: GÃœNÃœN SÃ–ZÃœ -->
      <div id="tab-quotes" class="tab-content">

        <div class="card-admin">
          <div class="flex items-center justify-between mb-6">
            <h2 class="flex items-center gap-2">
              <span class="material-symbols-outlined text-3xl text-indigo-500">format_quote</span>
              ğŸ’¬ GÃ¼nÃ¼n SÃ¶zÃ¼ YÃ¶netimi
            </h2>
            <button onclick="saveQuoteData()"
              class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-1 transition-colors shadow-sm">
              <span class="material-symbols-outlined text-lg">save</span>
              Kaydet
            </button>
          </div>

          <p class="text-gray-600 mb-6">
            SÃ¶zleri yÃ¶netin. Manuel olarak ekleyebilir veya toplu olarak iÃ§e aktarabilirsiniz. Tarihe gÃ¶re veya rastgele
            gÃ¶sterim yapabilirsiniz.
          </p>

          <!-- Kart BaÅŸlÄ±ÄŸÄ± -->
          <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <label class="input-label">Kart BaÅŸlÄ±ÄŸÄ±</label>
            <input id="quoteCardTitle" type="text" class="input-field"
              placeholder="Ã–rn: GÃ¼nÃ¼n SÃ¶zÃ¼, GÃ¼nÃ¼n Ayeti, Ã–zdeyiÅŸ">
            <p class="helper-text">Ana panoda gÃ¶sterilecek baÅŸlÄ±k (GÃ¼nÃ¼n SÃ¶zÃ¼, GÃ¼nÃ¼n Ayeti vb.)</p>
          </div>

          <!-- Manuel SÃ¶z Ekleme -->
          <div class="mb-6 p-4 bg-slate-50 rounded-xl border border-slate-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-primary">add_circle</span>
              Manuel SÃ¶z Ekle
            </h3>

            <div class="grid grid-cols-1 gap-4 mb-4">
              <div>
                <label class="input-label text-sm">SÃ¶z/AlÄ±ntÄ±</label>
                <textarea id="manualQuoteText" rows="3" class="input-field p-3 text-sm"
                  placeholder="Ã–rn: Hayatta en hakiki mÃ¼rÅŸit ilimdir."></textarea>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label class="input-label text-sm">Yazar/Kaynak</label>
                  <input id="manualQuoteAuthor" type="text" class="input-field p-2 text-sm"
                    placeholder="Ã–rn: M. Kemal AtatÃ¼rk">
                </div>
                <div>
                  <label class="input-label text-sm">Tarih (Opsiyonel)</label>
                  <input id="manualQuoteDate" type="date" class="input-field p-2 text-sm">
                  <p class="helper-text text-xs">Belirli bir tarihte gÃ¶sterilsin mi?</p>
                </div>
              </div>
            </div>

            <button onclick="addManualQuote()" class="btn-save">
              <span class="material-symbols-outlined text-sm mr-1">add</span>
              SÃ¶z Ekle
            </button>
          </div>

          <!-- Toplu Ä°Ã§e Aktarma -->
          <div class="mb-6 p-4 bg-green-50 rounded-xl border border-green-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-green-600">upload_file</span>
              Toplu SÃ¶z Ä°Ã§e Aktarma
            </h3>

            <div class="mb-4">
              <label class="input-label text-sm">Toplu SÃ¶z Verisi</label>
              <textarea id="bulkQuoteData" rows="8" class="input-field p-3 text-sm font-mono" placeholder="SÃ¶z|Yazar|Tarih
Hayatta en hakiki mÃ¼rÅŸit ilimdir.|M. Kemal AtatÃ¼rk|2025-01-15
Bilgi gÃ¼Ã§tÃ¼r.|Francis Bacon|
DÃ¼ÅŸÃ¼nmek en zor iÅŸtir.|Henry Ford|2025-02-20"></textarea>
              <p class="helper-text">
                ğŸ’¡ Format: SÃ¶z|Yazar|Tarih(YYYY-MM-DD, opsiyonel)<br>
                Her satÄ±ra bir sÃ¶z. Tarih belirtilmezse rastgele gÃ¶sterilir.<br>
                Ä°lk satÄ±r baÅŸlÄ±k olmalÄ±.
              </p>
            </div>

            <button onclick="importBulkQuotes()" class="btn-save bg-green-600 hover:bg-green-700">
              <span class="material-symbols-outlined text-sm mr-1">cloud_upload</span>
              Toplu Ä°Ã§e Aktar
            </button>
          </div>

          <!-- GÃ¶rÃ¼ntÃ¼leme SeÃ§enekleri -->
          <div class="mb-6 p-4 bg-purple-50 rounded-xl border border-purple-200">
            <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
              <span class="material-symbols-outlined text-purple-600">settings</span>
              GÃ¶rÃ¼ntÃ¼leme AyarlarÄ±
            </h3>

            <div class="space-y-3">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="enableQuoteSlider" class="w-5 h-5 accent-primary cursor-pointer"
                  onchange="toggleQuoteSliderSettings()">
                <span class="font-medium">Slayt modunu etkinleÅŸtir (Birden fazla sÃ¶z gÃ¶ster)</span>
              </label>

              <div id="quoteSliderSettings" class="ml-7 space-y-3 hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label class="input-label text-sm">Slayt GeÃ§iÅŸ HÄ±zÄ± (saniye)</label>
                    <input id="quoteSliderSpeed" type="number" min="3" max="30" value="8"
                      class="input-field p-2 text-sm w-full">
                  </div>
                  <div>
                    <label class="input-label text-sm">Max. GÃ¶sterilecek Slayt SayÄ±sÄ±</label>
                    <input id="quoteMaxSlides" type="number" min="1" max="100" value="5"
                      class="input-field p-2 text-sm w-full" placeholder="Ã–rn: 5">
                    <p class="helper-text text-xs">Havuzdan rastgele kaÃ§ sÃ¶z seÃ§ileceÄŸini belirler.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- SÃ¶z Listesi Tablosu -->
          <div class="mb-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-bold text-lg flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">list</span>
                SÃ¶z Listesi
                <span id="quoteCount" class="text-sm font-normal text-gray-500">(0 sÃ¶z)</span>
              </h3>
              <div class="flex gap-2">
                <button onclick="initQuoteData()"
                  class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-bold flex items-center gap-1">
                  <span class="material-symbols-outlined text-sm">refresh</span>
                  Listeyi Yenile
                </button>
                <button onclick="clearAllQuotes()"
                  class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-bold">
                  <span class="material-symbols-outlined text-sm mr-1">delete_sweep</span>
                  TÃ¼mÃ¼nÃ¼ Temizle
                </button>
              </div>
            </div>

            <div class="overflow-x-auto rounded-lg border border-slate-200">
              <table class="w-full text-left border-collapse text-sm">
                <thead>
                  <tr class="bg-slate-50 text-slate-600 uppercase tracking-wider">
                    <th class="p-3 border-b border-slate-200">#</th>
                    <th class="p-3 border-b border-slate-200">SÃ¶z</th>
                    <th class="p-3 border-b border-slate-200">Yazar</th>
                    <th class="p-3 border-b border-slate-200">Tarih</th>
                    <th class="p-3 border-b border-slate-200 text-right">Ä°ÅŸlem</th>
                  </tr>
                </thead>
                <tbody id="quoteTableBody">
                  <!-- JS ile doldurulacak -->
                </tbody>
              </table>
            </div>

            <div id="emptyQuoteMsg" class="hidden p-8 text-center text-slate-400 italic">
              HenÃ¼z sÃ¶z kaydÄ± bulunmuyor.
            </div>
          </div>

          <!-- Kaydet Butonu -->
          <div class="flex justify-end gap-3">
            <button onclick="saveQuoteData()" class="btn-save">
              ğŸ’¾ TÃ¼m DeÄŸiÅŸiklikleri Kaydet
            </button>
          </div>

        </div>

      </div>

      <!-- TAB: MEDYA MERKEZÄ° -->
      <div id="tab-media" class="tab-content">

        <div class="card-admin">
          <div class="flex items-center justify-between mb-6">
            <h2 class="flex items-center gap-2">
              <span class="material-symbols-outlined text-3xl text-primary">movie</span>
              ğŸ¬ Medya Merkezi - Ana GÃ¶rsel YÃ¶netimi
            </h2>
            <button onclick="saveMediaCenter()"
              class="bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-1 transition-colors shadow-sm">
              <span class="material-symbols-outlined text-lg">save</span>
              Kaydet
            </button>
          </div>

          <p class="text-gray-600 mb-6">
            Ana ekrandaki merkez kartÄ± iÃ§in medya tÃ¼rÃ¼nÃ¼ seÃ§in ve ayarlayÄ±n. Resim slaytÄ±, video veya web sayfasÄ±
            gÃ¶sterebilirsiniz.
          </p>

          <!-- Medya TÃ¼rÃ¼ SeÃ§imi -->
          <div class="mb-6">
            <label class="input-label">Medya TÃ¼rÃ¼</label>
            <div class="flex gap-3">
              <button onclick="setMediaType('slideshow')" id="btn-media-slideshow"
                class="media-type-btn flex-1 py-3 px-4 rounded-lg border-2 transition-all">
                <span class="material-symbols-outlined text-2xl mb-1">photo_library</span>
                <div class="font-bold">Resim SlaytÄ±</div>
                <div class="text-xs opacity-75">Birden fazla resim gÃ¶ster</div>
              </button>
              <button onclick="setMediaType('video')" id="btn-media-video"
                class="media-type-btn flex-1 py-3 px-4 rounded-lg border-2 transition-all">
                <span class="material-symbols-outlined text-2xl mb-1">play_circle</span>
                <div class="font-bold">Video</div>
                <div class="text-xs opacity-75">YouTube, Vimeo vb.</div>
              </button>
              <button onclick="setMediaType('webpage')" id="btn-media-webpage"
                class="media-type-btn flex-1 py-3 px-4 rounded-lg border-2 transition-all">
                <span class="material-symbols-outlined text-2xl mb-1">web</span>
                <div class="font-bold">Web SayfasÄ±</div>
                <div class="text-xs opacity-75">Ä°frame ile gÃ¶mme</div>
              </button>
            </div>
          </div>

          <!-- Tam Ekran SeÃ§eneÄŸi -->
          <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <label class="flex items-center gap-3 cursor-pointer">
              <input type="checkbox" id="mediaFullscreen" class="w-5 h-5 accent-primary cursor-pointer">
              <div>
                <div class="font-bold text-gray-800">Tam Ekran Modu</div>
                <div class="text-sm text-gray-600">Medya iÃ§eriÄŸi tÃ¼m ekranÄ± kaplasÄ±n (yan kartlar gizlenir)</div>
              </div>
            </label>
          </div>

          <!-- SLIDESHOW SETTINGS -->
          <div id="media-slideshow-settings" class="media-settings hidden">
            <div class="border-t pt-6 mt-6">
              <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">photo_library</span>
                Resim SlaytÄ± AyarlarÄ±
              </h3>

              <!-- Image List -->
              <div class="mb-4">
                <label class="input-label">Slayt Resimleri</label>
                <div id="slideshow-images-container" class="space-y-3 mb-3">
                  <!-- JS ile doldurulacak -->
                </div>
                <button onclick="addSlideshowImage()"
                  class="w-full py-2 border-2 border-dashed border-primary/30 text-primary font-bold rounded-lg hover:bg-primary/5 transition-colors">
                  + Resim Ekle
                </button>
                <p class="helper-text mt-2">
                  ğŸ’¡ Ä°pucu: <code>images/</code> klasÃ¶rÃ¼nden seÃ§im yapabilir veya tam URL girebilirsiniz.
                </p>
              </div>

              <!-- Slideshow Speed -->
              <div class="mb-4">
                <label class="input-label">Slayt GeÃ§iÅŸ HÄ±zÄ±</label>
                <div class="flex items-center gap-4">
                  <span class="text-sm text-gray-600 font-medium">HÄ±zlÄ±</span>
                  <input id="slideshowSpeed" type="range" min="2" max="15" value="5" step="1"
                    class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary"
                    oninput="updateSlideshowSpeedLabel()">
                  <span class="text-sm text-gray-600 font-medium">YavaÅŸ</span>
                </div>
                <p class="helper-text mt-2">
                  SÃ¼re: <span id="slideshowSpeedLabel" class="font-bold text-primary">5</span> saniye
                </p>
              </div>
            </div>
          </div>

          <!-- VIDEO SETTINGS -->
          <div id="media-video-settings" class="media-settings hidden">
            <div class="border-t pt-6 mt-6">
              <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">play_circle</span>
                Video AyarlarÄ±
              </h3>

              <div class="mb-4">
                <label class="input-label">Video URL</label>
                <input id="videoUrl" type="url" class="input-field"
                  placeholder="https://www.youtube.com/watch?v=... veya https://vimeo.com/...">
                <p class="helper-text">
                  YouTube, Vimeo, veya doÄŸrudan video dosyasÄ± URL'si girebilirsiniz.
                </p>
              </div>

              <div class="mb-4">
                <label class="flex items-center gap-2">
                  <input type="checkbox" id="videoAutoplay" class="accent-primary">
                  <span class="font-medium">Otomatik Oynat</span>
                </label>
              </div>

              <div class="mb-4">
                <label class="flex items-center gap-2">
                  <input type="checkbox" id="videoLoop" class="accent-primary">
                  <span class="font-medium">DÃ¶ngÃ¼ (Tekrar Oynat)</span>
                </label>
              </div>

              <div class="mb-4">
                <label class="flex items-center gap-2">
                  <input type="checkbox" id="videoMuted" class="accent-primary">
                  <span class="font-medium">Sessiz BaÅŸlat</span>
                </label>
              </div>
            </div>
          </div>

          <!-- WEBPAGE SETTINGS -->
          <div id="media-webpage-settings" class="media-settings hidden">
            <div class="border-t pt-6 mt-6">
              <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">web</span>
                Web SayfasÄ± GÃ¶mme AyarlarÄ±
              </h3>

              <div class="mb-4">
                <label class="input-label">Web SayfasÄ± URL</label>
                <input id="webpageUrl" type="url" class="input-field" placeholder="https://example.com">
                <p class="helper-text">
                  GÃ¶mmek istediÄŸiniz web sayfasÄ±nÄ±n tam URL'sini girin.
                </p>
              </div>

              <div class="mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <div class="flex gap-2">
                  <span class="material-symbols-outlined text-yellow-600">warning</span>
                  <div class="text-sm text-yellow-800">
                    <strong>Not:</strong> BazÄ± web siteleri gÃ¼venlik nedeniyle iframe iÃ§inde gÃ¶sterilmeye izin vermez.
                    Bu durumda sayfa gÃ¶rÃ¼ntÃ¼lenemeyebilir.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Save Button -->
          <div class="mt-6 pt-6 border-t">
            <button onclick="saveMediaCenter()" class="btn-save w-full">
              ğŸ’¾ Medya AyarlarÄ±nÄ± Kaydet
            </button>
          </div>

        </div>

      </div>

      <!-- TAB: DERS PROGRAMI -->
      <div id="tab-schedule" class="tab-content">

        <div class="card-admin">
          <div class="flex items-center justify-between mb-6">
            <h2 class="flex items-center gap-2">
              <span class="material-symbols-outlined text-3xl text-amber-600">calendar_month</span>
              ğŸ“š Ders ProgramÄ± YÃ¶netimi
            </h2>
            <button onclick="saveAllSchedules()"
              class="bg-amber-600 hover:bg-amber-700 text-white px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-1 transition-colors shadow-sm">
              <span class="material-symbols-outlined text-lg">save</span>
              Kaydet
            </button>
          </div>

          <!-- YENÄ° DERS EKLEME FORMU -->
          <div class="bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6 shadow-sm">
            <h3 class="font-bold text-text-dark mb-3 flex items-center gap-2">
              <span class="material-symbols-outlined text-primary">add_circle</span> Yeni Ders Ekle
            </h3>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">

              <!-- GÃ¼n ve SÄ±nÄ±f -->
              <div class="space-y-3">
                <div>
                  <label class="input-label">GÃ¼n</label>
                  <select id="schDay" class="input-field bg-white">
                    <option value="Pazartesi">Pazartesi</option>
                    <option value="SalÄ±">SalÄ±</option>
                    <option value="Ã‡arÅŸamba">Ã‡arÅŸamba</option>
                    <option value="PerÅŸembe">PerÅŸembe</option>
                    <option value="Cuma">Cuma</option>
                    <option value="Cumartesi">Cumartesi</option>
                    <option value="Pazar">Pazar</option>
                  </select>
                </div>
                <div>
                  <label class="input-label">SÄ±nÄ±f</label>
                  <input id="schClass" type="text" class="input-field" placeholder="9-A">
                </div>
              </div>

              <!-- Ders ve Ã–ÄŸretmen -->
              <div class="space-y-3">
                <div>
                  <label class="input-label">Ders AdÄ±</label>
                  <input id="schTitle" type="text" class="input-field" placeholder="Matematik">
                </div>
                <div>
                  <label class="input-label">Ã–ÄŸretmen</label>
                  <input id="schTeacher" type="text" class="input-field" placeholder="Ad Soyad">
                </div>
              </div>

              <!-- Zamanlama -->
              <div class="col-span-1 md:col-span-2 lg:col-span-2 space-y-3">
                <label class="input-label">Ders Saati (BaÅŸlangÄ±Ã§ - BitiÅŸ)</label>
                <div class="flex items-center gap-2 bg-white p-2 rounded border border-slate-200">
                  <!-- BaÅŸlangÄ±Ã§ -->
                  <select id="startHour" class="bg-transparent font-mono outline-none"></select>
                  <span class="font-bold">:</span>
                  <select id="startMin" class="bg-transparent font-mono outline-none"></select>

                  <span class="text-slate-400 mx-2">â</span>

                  <!-- BitiÅŸ -->
                  <select id="endHour" class="bg-transparent font-mono outline-none"></select>
                  <span class="font-bold">:</span>
                  <select id="endMin" class="bg-transparent font-mono outline-none"></select>
                </div>
                <p class="text-xs text-gray-500 mt-1">Ã–rn: 08:30 - 09:10</p>
              </div>

            </div>

            <button onclick="addNewSchedule()"
              class="w-full py-2.5 bg-primary text-white font-bold rounded-lg hover:bg-primary-dark transition-colors shadow-sm flex items-center justify-center gap-2">
              <span class="material-symbols-outlined">save</span> Ders ProgramÄ±na Ekle
            </button>
          </div>

          <!-- GÃœN SEKMELERÄ° -->
          <div class="flex flex-wrap gap-2 border-b border-gray-200 mb-4 pb-1">
            <button onclick="setScheduleDay('Pazartesi')"
              class="sch-day-btn px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border border-transparent hover:bg-slate-50"
              data-day="Pazartesi">Pazartesi</button>
            <button onclick="setScheduleDay('SalÄ±')"
              class="sch-day-btn px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border border-transparent hover:bg-slate-50"
              data-day="SalÄ±">SalÄ±</button>
            <button onclick="setScheduleDay('Ã‡arÅŸamba')"
              class="sch-day-btn px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border border-transparent hover:bg-slate-50"
              data-day="Ã‡arÅŸamba">Ã‡arÅŸamba</button>
            <button onclick="setScheduleDay('PerÅŸembe')"
              class="sch-day-btn px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border border-transparent hover:bg-slate-50"
              data-day="PerÅŸembe">PerÅŸembe</button>
            <button onclick="setScheduleDay('Cuma')"
              class="sch-day-btn px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border border-transparent hover:bg-slate-50"
              data-day="Cuma">Cuma</button>
            <button onclick="setScheduleDay('Cumartesi')"
              class="sch-day-btn px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border border-transparent hover:bg-slate-50"
              data-day="Cumartesi">Cumartesi</button>
            <button onclick="setScheduleDay('Pazar')"
              class="sch-day-btn px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border border-transparent hover:bg-slate-50"
              data-day="Pazar">Pazar</button>
          </div>

          <!-- DERS LÄ°STESÄ° TABLOSU -->
          <div class="overflow-x-auto rounded-lg border border-slate-200">
            <table class="w-full text-left border-collapse">
              <thead>
                <tr class="bg-slate-50 text-slate-600 text-sm uppercase tracking-wider">
                  <th class="p-3 border-b border-slate-200">SÄ±nÄ±f</th>
                  <th class="p-3 border-b border-slate-200">Ders</th>
                  <th class="p-3 border-b border-slate-200">Ã–ÄŸretmen</th>
                  <th class="p-3 border-b border-slate-200">Saat</th>
                  <th class="p-3 border-b border-slate-200 text-right">Ä°ÅŸlem</th>
                </tr>
              </thead>
              <tbody id="scheduleTableBody" class="text-sm">
                <!-- JS ile doldurulacak -->
              </tbody>
            </table>
          </div>

          <div id="emptyScheduleMsg" class="hidden p-8 text-center text-slate-400 italic">
            Bu gÃ¼ne ait ders kaydÄ± bulunamadÄ±.
          </div>

          <div class="mt-4 flex justify-end">
            <button onclick="saveAllSchedules()" class="btn-save ml-2 flex items-center gap-2">
              <span class="material-symbols-outlined">cloud_upload</span> DeÄŸiÅŸiklikleri Kaydet
            </button>
          </div>
        </div>

        <!-- DERS & TENEFFÃœS SAATLERÄ° -->
        <div class="card-admin mt-6">
          <h2>â± Ders ve TeneffÃ¼s Saatleri</h2>

          <div class="mb-4 grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
            <div>
              <label class="input-label">GÃ¼n</label>
              <select id="tpDay" class="input-field bg-white" onchange="setTimePlanDay(this.value)">
                <option value="Pazartesi">Pazartesi</option>
                <option value="SalÄ±">SalÄ±</option>
                <option value="Ã‡arÅŸamba">Ã‡arÅŸamba</option>
                <option value="PerÅŸembe">PerÅŸembe</option>
                <option value="Cuma">Cuma</option>
                <option value="Cumartesi">Cumartesi</option>
                <option value="Pazar">Pazar</option>
              </select>
              <p class="helper-text">Her gÃ¼n iÃ§in ders ve teneffÃ¼s zamanlarÄ±nÄ± ayrÄ± ayrÄ± girin.</p>
            </div>
            <div class="md:col-span-2 flex md:justify-end mt-4 md:mt-0">
              <button onclick="addTimePlanRow()"
                class="w-full md:w-auto py-2 border-2 border-dashed border-primary/30 text-primary font-bold rounded-lg hover:bg-primary/5 transition-colors flex items-center justify-center gap-1">
                <span class="material-symbols-outlined">add</span>
                SatÄ±r Ekle
              </button>
            </div>
          </div>

          <div class="overflow-x-auto rounded-lg border border-slate-200">
            <table class="w-full text-left border-collapse text-sm">
              <thead>
                <tr class="bg-slate-50 text-slate-600 uppercase tracking-wider">
                  <th class="p-3 border-b border-slate-200">Tip</th>
                  <th class="p-3 border-b border-slate-200">Ad (1. Ders / TeneffÃ¼s 1)</th>
                  <th class="p-3 border-b border-slate-200">BaÅŸlangÄ±Ã§</th>
                  <th class="p-3 border-b border-slate-200">BitiÅŸ</th>
                  <th class="p-3 border-b border-slate-200 text-right">Ä°ÅŸlem</th>
                </tr>
              </thead>
              <tbody id="timePlanTableBody">
                <!-- JS ile doldurulacak -->
              </tbody>
            </table>
          </div>

          <p id="emptyTimePlanMsg" class="p-4 text-center text-slate-400 italic hidden">
            Bu gÃ¼ne ait saat bilgisi girilmemiÅŸ.
          </p>

          <div class="mt-4 flex justify-end">
            <button onclick="saveTimePlan()" class="btn-save ml-2 flex items-center gap-2">
              <span class="material-symbols-outlined">schedule</span> Ders & TeneffÃ¼s Saatlerini Kaydet
            </button>
          </div>
        </div>

      </div>

      <!-- JS Helper for this section -->
      <script>
        // Populate Time Comboboxes
        const hours = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24];
        const minutes = [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55];

        function fillTimeSelects() {
          const selects = ['startHour', 'endHour'];
          const minSelects = ['startMin', 'endMin'];

          selects.forEach(id => {
            const el = document.getElementById(id);
            hours.forEach(h => {
              const opt = document.createElement('option');
              opt.value = h.toString().padStart(2, '0');
              opt.text = h.toString().padStart(2, '0');
              el.appendChild(opt);
            });
          });

          minSelects.forEach(id => {
            const el = document.getElementById(id);
            minutes.forEach(m => {
              const opt = document.createElement('option');
              opt.value = m.toString().padStart(2, '0');
              opt.text = m.toString().padStart(2, '0');
              el.appendChild(opt);
            });
          });

          // Set defaults
          document.getElementById('startHour').value = '08';
          document.getElementById('startMin').value = '30';
          document.getElementById('endHour').value = '09';
          document.getElementById('endMin').value = '10';
        }
        fillTimeSelects();
      </script>

    </div>

    <!-- Back Button -->
    <div class="text-center mt-10">
      <a href="index.html" class="btn-back">
        <span class="material-symbols-outlined">arrow_back</span>
        Pano'ya DÃ¶n
      </a>
    </div>

  </div>

  <script>
    // Populate fields
    document.getElementById("schoolName").value = data.schoolName || "";

    // Birthday Management - New System
    let birthdayStudents = [];
    let showAllBirthdays = false;

    async function initBirthdayData() {
      console.log('ğŸ‚ initBirthdayData baÅŸladÄ±...');

      // Global data objesinin var olduÄŸundan emin ol
      if (!data) {
        data = {};
      }
      if (!data.cards) {
        data.cards = {};
      }

      try {
        // DoÄŸrudan Firebase'den Ã§ek (modal'daki gibi)
        const snapshot = await firebase.database().ref('panoData/cards/birthdays').once('value');
        const birthdaysData = snapshot.val();

        console.log('ğŸ‚ Firebase\'den Ã§ekilen birthdaysData:', birthdaysData);

        if (!birthdaysData) {
          console.log('ğŸ‚ Firebase\'de birthdays verisi yok, boÅŸ baÅŸlatÄ±lÄ±yor...');
          data.cards.birthdays = {
            enabled: true,
            title: "Ä°yi ki doÄŸdun!",
            students: []
          };
          birthdayStudents = [];
          document.getElementById("bTitle").value = "Ä°yi ki doÄŸdun!";
          renderBirthdayTable();
          return;
        }

        // Global data objesini gÃ¼ncelle
        data.cards.birthdays = birthdaysData;

        // students verisini al
        let studentsData = birthdaysData.students;
        console.log('ğŸ‚ studentsData raw:', studentsData);
        console.log('ğŸ‚ studentsData type:', typeof studentsData);

        // Firebase'de array veriler bazen object olarak saklanabilir
        if (studentsData && typeof studentsData === 'object' && !Array.isArray(studentsData)) {
          console.log('ğŸ‚ Object -> Array dÃ¶nÃ¼ÅŸÃ¼mÃ¼ yapÄ±lÄ±yor...');
          studentsData = Object.values(studentsData);
          data.cards.birthdays.students = studentsData;
        }

        birthdayStudents = studentsData || [];
        console.log('ğŸ‚ birthdayStudents final length:', birthdayStudents.length);

        // UI gÃ¼ncelle
        document.getElementById("bTitle").value = birthdaysData.title || "Ä°yi ki doÄŸdun!";

        renderBirthdayTable();
        console.log('ğŸ‚ initBirthdayData tamamlandÄ± - ' + birthdayStudents.length + ' Ã¶ÄŸrenci yÃ¼klendi');

      } catch (error) {
        console.error('ğŸ‚ initBirthdayData HATA:', error);
        // Hata durumunda boÅŸ baÅŸlat
        birthdayStudents = [];
        renderBirthdayTable();
      }
    }

    function addManualBirthday() {
      const name = document.getElementById("manualName").value.trim();
      const surname = document.getElementById("manualSurname").value.trim();
      const gender = document.getElementById("manualGender").value;
      const birthdate = document.getElementById("manualBirthdate").value;
      const note = document.getElementById("manualNote").value.trim();

      if (!name || !surname || !birthdate) {
        alert("âš ï¸ LÃ¼tfen en azÄ±ndan Ad, Soyad ve DoÄŸum Tarihi alanlarÄ±nÄ± doldurun!");
        return;
      }

      birthdayStudents.push({
        name,
        surname,
        gender,
        birthdate,
        note
      });

      // Clear form
      document.getElementById("manualName").value = "";
      document.getElementById("manualSurname").value = "";
      document.getElementById("manualGender").value = "E";
      document.getElementById("manualBirthdate").value = "";
      document.getElementById("manualNote").value = "";

      renderBirthdayTable();
      alert("âœ… Ã–ÄŸrenci eklendi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
    }

    function importFromExcel() {
      const excelData = document.getElementById("excelData").value.trim();

      if (!excelData) {
        alert("âš ï¸ LÃ¼tfen Excel verisini yapÄ±ÅŸtÄ±rÄ±n!");
        return;
      }

      const lines = excelData.split('\n').map(line => line.trim()).filter(line => line);

      if (lines.length < 2) {
        alert("âš ï¸ En az bir baÅŸlÄ±k satÄ±rÄ± ve bir veri satÄ±rÄ± olmalÄ±!");
        return;
      }

      let imported = 0;
      let errors = 0;

      // Skip header line (index 0)
      for (let i = 1; i < lines.length; i++) {
        const parts = lines[i].split(',').map(p => p.trim());

        if (parts.length < 4) {
          errors++;
          continue;
        }

        const [name, surname, gender, birthdate, note = ""] = parts;

        if (!name || !surname || !birthdate) {
          errors++;
          continue;
        }

        birthdayStudents.push({
          name,
          surname,
          gender: gender.toUpperCase(),
          birthdate,
          note
        });

        imported++;
      }

      document.getElementById("excelData").value = "";
      renderBirthdayTable();

      alert(`âœ… ${imported} Ã¶ÄŸrenci iÃ§e aktarÄ±ldÄ±!${errors > 0 ? `\nâš ï¸ ${errors} satÄ±r hatalÄ± olduÄŸu iÃ§in atlandÄ±.` : ''}\n\nDeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.`);
    }

    function calculateAge(birthdate) {
      const today = new Date();
      const birth = new Date(birthdate);
      let age = today.getFullYear() - birth.getFullYear();
      const monthDiff = today.getMonth() - birth.getMonth();

      if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
        age--;
      }

      return age;
    }

    function isBirthdayToday(birthdate) {
      const today = new Date();
      const birth = new Date(birthdate);

      return today.getMonth() === birth.getMonth() && today.getDate() === birth.getDate();
    }

    function toggleBirthdayFilter() {
      showAllBirthdays = document.getElementById("showAllBirthdays").checked;
      renderBirthdayTable();
    }

    function renderBirthdayTable() {
      const tbody = document.getElementById("birthdayTableBody");
      const emptyMsg = document.getElementById("emptyBirthdayMsg");
      const studentCount = document.getElementById("studentCount");

      tbody.innerHTML = "";

      let filteredStudents = birthdayStudents;

      // Filter by today's birthdays if checkbox is not checked
      if (!showAllBirthdays) {
        filteredStudents = birthdayStudents.filter(student => isBirthdayToday(student.birthdate));
      } else {
        // Sort by month and day
        filteredStudents = [...birthdayStudents].sort((a, b) => {
          const dateA = new Date(a.birthdate);
          const dateB = new Date(b.birthdate);

          if (dateA.getMonth() !== dateB.getMonth()) {
            return dateA.getMonth() - dateB.getMonth();
          }
          return dateA.getDate() - dateB.getDate();
        });
      }

      studentCount.textContent = `(${filteredStudents.length} Ã¶ÄŸrenci)`;

      if (filteredStudents.length === 0) {
        emptyMsg.classList.remove("hidden");
        return;
      }

      emptyMsg.classList.add("hidden");

      filteredStudents.forEach((student, index) => {
        const originalIndex = birthdayStudents.indexOf(student);
        const tr = document.createElement("tr");
        tr.className = "border-b border-slate-100 hover:bg-slate-50 transition-colors";
        tr.id = `birthday-row-${originalIndex}`;

        const genderIcon = student.gender === "K" ? "ğŸ‘§" : "ğŸ‘¦";
        const genderText = student.gender === "K" ? "KÄ±z" : "Erkek";
        const isTodayBirthday = isBirthdayToday(student.birthdate);
        const rowClass = isTodayBirthday ? "bg-pink-50" : "";

        tr.className += ` ${rowClass}`;

        tr.innerHTML = `
          <td class="p-3 font-semibold text-slate-700">${index + 1}</td>
          <td class="p-3 text-slate-800 font-medium">
            ${student.name} ${student.surname}
            ${isTodayBirthday ? '<span class="ml-2 text-pink-500">ğŸ‚</span>' : ''}
          </td>
          <td class="p-3 text-slate-600">${genderIcon} ${genderText}</td>
          <td class="p-3 font-mono text-sm text-slate-500">${student.birthdate}</td>
          <td class="p-3 text-slate-600">${calculateAge(student.birthdate)}</td>
          <td class="p-3 text-slate-600 text-sm">${student.note || '-'}</td>
          <td class="p-3 text-right">
            <button onclick="editBirthdayStudent(${originalIndex})" 
              class="text-blue-500 hover:bg-blue-50 p-2 rounded transition-colors mr-1" title="DÃ¼zenle">
              <span class="material-symbols-outlined text-lg">edit</span>
            </button>
            <button onclick="removeBirthdayStudent(${originalIndex})" 
              class="text-red-500 hover:bg-red-50 p-2 rounded transition-colors" title="Sil">
              <span class="material-symbols-outlined text-lg">delete</span>
            </button>
          </td>
        `;

        tbody.appendChild(tr);
      });
    }

    function editBirthdayStudent(index) {
      const student = birthdayStudents[index];
      const row = document.getElementById(`birthday-row-${index}`);

      row.innerHTML = `
        <td class="p-3 font-semibold text-slate-700">${birthdayStudents.indexOf(student) + 1}</td>
        <td class="p-3" colspan="2">
          <div class="grid grid-cols-3 gap-2">
            <input type="text" id="edit-birthday-name-${index}" value="${student.name}" 
              class="input-field p-2 text-sm" placeholder="Ad">
            <input type="text" id="edit-birthday-surname-${index}" value="${student.surname}" 
              class="input-field p-2 text-sm" placeholder="Soyad">
            <select id="edit-birthday-gender-${index}" class="input-field p-2 text-sm bg-white">
              <option value="E" ${student.gender === 'E' ? 'selected' : ''}>Erkek</option>
              <option value="K" ${student.gender === 'K' ? 'selected' : ''}>KÄ±z</option>
            </select>
          </div>
        </td>
        <td class="p-3">
          <input type="date" id="edit-birthday-date-${index}" value="${student.birthdate}" 
            class="input-field p-2 text-sm w-full">
        </td>
        <td class="p-3">
          <span class="text-slate-400 text-sm">Otomatik</span>
        </td>
        <td class="p-3">
          <input type="text" id="edit-birthday-note-${index}" value="${student.note || ''}" 
            class="input-field p-2 text-sm w-full" placeholder="Not">
        </td>
        <td class="p-3 text-right">
          <button onclick="saveEditBirthdayStudent(${index})" 
            class="text-green-500 hover:bg-green-50 p-2 rounded transition-colors mr-1" title="Kaydet">
            <span class="material-symbols-outlined text-lg">check</span>
          </button>
          <button onclick="renderBirthdayTable()" 
            class="text-gray-500 hover:bg-gray-50 p-2 rounded transition-colors" title="Ä°ptal">
            <span class="material-symbols-outlined text-lg">close</span>
          </button>
        </td>
      `;
    }

    function saveEditBirthdayStudent(index) {
      const name = document.getElementById(`edit-birthday-name-${index}`).value.trim();
      const surname = document.getElementById(`edit-birthday-surname-${index}`).value.trim();
      const gender = document.getElementById(`edit-birthday-gender-${index}`).value;
      const birthdate = document.getElementById(`edit-birthday-date-${index}`).value;
      const note = document.getElementById(`edit-birthday-note-${index}`).value.trim();

      if (!name || !surname || !birthdate) {
        alert("âš ï¸ LÃ¼tfen Ad, Soyad ve DoÄŸum Tarihi alanlarÄ±nÄ± doldurun!");
        return;
      }

      birthdayStudents[index] = { name, surname, gender, birthdate, note };
      renderBirthdayTable();
      alert("âœ… Ã–ÄŸrenci bilgileri gÃ¼ncellendi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
    }

    function removeBirthdayStudent(index) {
      if (confirm("Bu Ã¶ÄŸrenciyi silmek istediÄŸinizden emin misiniz?")) {
        birthdayStudents.splice(index, 1);
        renderBirthdayTable();
        alert("âœ… Ã–ÄŸrenci silindi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
      }
    }

    function clearAllBirthdays() {
      if (confirm("âš ï¸ TÃœM Ã¶ÄŸrenci kayÄ±tlarÄ±nÄ± silmek istediÄŸinizden emin misiniz?\n\nBu iÅŸlem geri alÄ±namaz!")) {
        if (confirm("Son kez soruyoruz: TÃ¼m kayÄ±tlar silinecek, emin misiniz?")) {
          birthdayStudents = [];
          renderBirthdayTable();
          alert("âœ… TÃ¼m kayÄ±tlar silindi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
        }
      }
    }

    async function saveBirthdayData() {
      data.cards.birthdays = {
        enabled: document.getElementById("birthdayEnabled").checked,
        title: document.getElementById("bTitle").value,
        students: birthdayStudents
      };

      await saveData(data);
      alert(`âœ… DoÄŸum gÃ¼nÃ¼ verileri kaydedildi!\n\nToplam ${birthdayStudents.length} Ã¶ÄŸrenci kaydÄ± bulunuyor.`);
    }

    // Initialize birthday data on page load
    // MOVED TO DOMContentLoaded - initBirthdayData();

    // ===== DUTY TEACHER MANAGEMENT =====
    let dutyEntries = [];
    let dutyEntryCounter = 0;

    async function initDutyData() {
      console.log('ğŸ‘® initDutyData baÅŸladÄ±...');

      // Global data objesinin var olduÄŸundan emin ol
      if (!data) {
        data = {};
      }
      if (!data.cards) {
        data.cards = {};
      }

      try {
        // DoÄŸrudan Firebase'den Ã§ek
        const snapshot = await firebase.database().ref('panoData/cards/dutyByDate').once('value');
        const dutyData = snapshot.val();

        console.log('ğŸ‘® Firebase\'den Ã§ekilen dutyData:', dutyData);

        if (!dutyData) {
          console.log('ğŸ‘® Firebase\'de dutyByDate verisi yok, boÅŸ baÅŸlatÄ±lÄ±yor...');
          data.cards.dutyByDate = { items: [] };
          dutyEntries = [];
          renderDutyTable();
          if (dutyEntryCounter === 0) {
            addDutyEntryRow();
          }
          return;
        }

        // Global data objesini gÃ¼ncelle
        data.cards.dutyByDate = dutyData;

        // items verisini al
        let itemsData = dutyData.items;
        console.log('ğŸ‘® itemsData raw:', itemsData);

        // Firebase'de array veriler bazen object olarak saklanabilir
        if (itemsData && typeof itemsData === 'object' && !Array.isArray(itemsData)) {
          console.log('ğŸ‘® Object -> Array dÃ¶nÃ¼ÅŸÃ¼mÃ¼ yapÄ±lÄ±yor...');
          itemsData = Object.values(itemsData);
          data.cards.dutyByDate.items = itemsData;
        }

        dutyEntries = itemsData || [];
        console.log('ğŸ‘® dutyEntries final length:', dutyEntries.length);

        renderDutyTable();
        console.log('ğŸ‘® initDutyData tamamlandÄ± - ' + dutyEntries.length + ' kayÄ±t yÃ¼klendi');

        // Add initial entry row
        if (dutyEntryCounter === 0) {
          addDutyEntryRow();
        }

      } catch (error) {
        console.error('ğŸ‘® initDutyData HATA:', error);
        dutyEntries = [];
        renderDutyTable();
        if (dutyEntryCounter === 0) {
          addDutyEntryRow();
        }
      }
    }

    function getTurkishDayName(dateStr) {
      if (!dateStr) return "";
      const d = new Date(dateStr);
      if (isNaN(d.getTime())) return "";
      const days = ["Pazar", "Pazartesi", "SalÄ±", "Ã‡arÅŸamba", "PerÅŸembe", "Cuma", "Cumartesi"];
      return days[d.getDay()];
    }

    function addDutyEntryRow() {
      const container = document.getElementById('dutyEntriesContainer');
      const rowId = dutyEntryCounter++;

      const rowDiv = document.createElement('div');
      rowDiv.className = 'grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-white rounded-lg border border-slate-200';
      rowDiv.id = `duty-entry-${rowId}`;

      rowDiv.innerHTML = `
        <div>
          <label class="input-label text-sm">Tarih</label>
          <input type="date" id="dutyEntryDate-${rowId}" class="input-field p-2 text-sm">
        </div>
        <div>
          <label class="input-label text-sm">Yer AdÄ±</label>
          <input type="text" id="dutyEntryPlace-${rowId}" class="input-field p-2 text-sm" placeholder="Ã–rn: Zemin Kat, BahÃ§e">
        </div>
        <div>
          <label class="input-label text-sm">Ã–ÄŸretmen AdÄ±</label>
          <div class="flex gap-2">
            <input type="text" id="dutyEntryTeacher-${rowId}" class="input-field p-2 text-sm flex-1" placeholder="Ã–rn: Ahmet YÄ±lmaz">
            <button onclick="addDutyFromRow(${rowId})" 
              class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-bold">
              Ekle
            </button>
          </div>
        </div>
      `;

      container.appendChild(rowDiv);
    }

    function addDutyFromRow(rowId) {
      const dateInput = document.getElementById(`dutyEntryDate-${rowId}`);
      const placeInput = document.getElementById(`dutyEntryPlace-${rowId}`);
      const teacherInput = document.getElementById(`dutyEntryTeacher-${rowId}`);

      const date = dateInput.value.trim();
      const place = placeInput.value.trim();
      const teacher = teacherInput.value.trim();

      if (!date || !place || !teacher) {
        alert("âš ï¸ LÃ¼tfen Tarih, Yer AdÄ± ve Ã–ÄŸretmen AdÄ± alanlarÄ±nÄ± doldurun!");
        return;
      }

      const dayName = getTurkishDayName(date);

      dutyEntries.push({
        date,
        day: dayName,
        place,
        teacher
      });

      // Clear inputs
      dateInput.value = "";
      placeInput.value = "";
      teacherInput.value = "";

      renderDutyTable();
      alert("âœ… NÃ¶betÃ§i eklendi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
    }

    function renderDutyTable() {
      const tbody = document.getElementById("dutyTableBody");
      const emptyMsg = document.getElementById("emptyDutyMsg");
      const dutyCount = document.getElementById("dutyCount");

      tbody.innerHTML = "";

      // Sort by date
      const sortedEntries = [...dutyEntries].sort((a, b) => {
        return new Date(a.date) - new Date(b.date);
      });

      dutyCount.textContent = `(${sortedEntries.length} kayÄ±t)`;

      if (sortedEntries.length === 0) {
        emptyMsg.classList.remove("hidden");
        return;
      }

      emptyMsg.classList.add("hidden");

      sortedEntries.forEach((duty, index) => {
        const originalIndex = dutyEntries.indexOf(duty);
        const tr = document.createElement("tr");
        tr.className = "border-b border-slate-100 hover:bg-slate-50 transition-colors";
        tr.id = `duty-row-${originalIndex}`;

        // Check if this duty is for today
        const today = new Date().toISOString().split('T')[0];
        const isToday = duty.date === today;
        const rowClass = isToday ? "bg-blue-50" : "";

        tr.className += ` ${rowClass}`;

        tr.innerHTML = `
          <td class="p-3 font-semibold text-slate-700">${index + 1}</td>
          <td class="p-3 font-mono text-sm text-slate-500">
            ${duty.date}
            ${isToday ? '<span class="ml-2 text-blue-500">ğŸ“… BugÃ¼n</span>' : ''}
          </td>
          <td class="p-3 text-slate-600">${duty.day || '-'}</td>
          <td class="p-3 text-slate-800 font-medium">${duty.place}</td>
          <td class="p-3 text-slate-800">${duty.teacher}</td>
          <td class="p-3 text-right">
            <button onclick="editDutyEntry(${originalIndex})" 
              class="text-blue-500 hover:bg-blue-50 p-2 rounded transition-colors mr-1" title="DÃ¼zenle">
              <span class="material-symbols-outlined text-lg">edit</span>
            </button>
            <button onclick="removeDutyEntry(${originalIndex})" 
              class="text-red-500 hover:bg-red-50 p-2 rounded transition-colors" title="Sil">
              <span class="material-symbols-outlined text-lg">delete</span>
            </button>
          </td>
        `;

        tbody.appendChild(tr);
      });
    }

    function removeDutyEntry(index) {
      if (confirm("Bu nÃ¶betÃ§i kaydÄ±nÄ± silmek istediÄŸinizden emin misiniz?")) {
        dutyEntries.splice(index, 1);
        renderDutyTable();
        alert("âœ… NÃ¶betÃ§i kaydÄ± silindi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
      }
    }

    function editDutyEntry(index) {
      const duty = dutyEntries[index];
      const row = document.getElementById(`duty-row-${index}`);

      if (!row || !duty) return;

      // Replace row with editable inputs
      row.innerHTML = `
        <td class="p-3 font-semibold text-slate-700">#</td>
        <td class="p-3">
          <input type="date" id="edit-duty-date-${index}" value="${duty.date}" class="input-field p-2 text-sm w-full">
        </td>
        <td class="p-3">
          <input type="text" id="edit-duty-day-${index}" value="${duty.day || ''}" class="input-field p-2 text-sm w-full" placeholder="GÃ¼n" readonly>
        </td>
        <td class="p-3">
          <input type="text" id="edit-duty-place-${index}" value="${duty.place}" class="input-field p-2 text-sm w-full" placeholder="Yer">
        </td>
        <td class="p-3">
          <input type="text" id="edit-duty-teacher-${index}" value="${duty.teacher}" class="input-field p-2 text-sm w-full" placeholder="Ã–ÄŸretmen">
        </td>
        <td class="p-3 text-right">
          <button onclick="saveEditDutyEntry(${index})" 
            class="text-green-500 hover:bg-green-50 p-2 rounded transition-colors mr-1" title="Kaydet">
            <span class="material-symbols-outlined text-lg">check</span>
          </button>
          <button onclick="renderDutyTable()" 
            class="text-gray-500 hover:bg-gray-50 p-2 rounded transition-colors" title="Ä°ptal">
            <span class="material-symbols-outlined text-lg">close</span>
          </button>
        </td>
      `;

      // Update day name when date changes
      document.getElementById(`edit-duty-date-${index}`).addEventListener('change', function () {
        const dayInput = document.getElementById(`edit-duty-day-${index}`);
        dayInput.value = getTurkishDayName(this.value);
      });
    }

    function saveEditDutyEntry(index) {
      const date = document.getElementById(`edit-duty-date-${index}`).value.trim();
      const day = document.getElementById(`edit-duty-day-${index}`).value.trim();
      const place = document.getElementById(`edit-duty-place-${index}`).value.trim();
      const teacher = document.getElementById(`edit-duty-teacher-${index}`).value.trim();

      if (!date || !place || !teacher) {
        alert("âš ï¸ LÃ¼tfen Tarih, Yer ve Ã–ÄŸretmen alanlarÄ±nÄ± doldurun!");
        return;
      }

      dutyEntries[index] = {
        date,
        day: day || getTurkishDayName(date),
        place,
        teacher
      };

      renderDutyTable();
      alert("âœ… NÃ¶betÃ§i kaydÄ± gÃ¼ncellendi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
    }

    function clearAllDuties() {
      if (confirm("âš ï¸ TÃœM nÃ¶betÃ§i kayÄ±tlarÄ±nÄ± silmek istediÄŸinizden emin misiniz?\n\nBu iÅŸlem geri alÄ±namaz!")) {
        if (confirm("Son kez soruyoruz: TÃ¼m kayÄ±tlar silinecek, emin misiniz?")) {
          dutyEntries = [];
          renderDutyTable();
          alert("âœ… TÃ¼m kayÄ±tlar silindi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
        }
      }
    }

    function importBulkDuties() {
      const bulkData = document.getElementById("bulkDutyData").value.trim();

      if (!bulkData) {
        alert("âš ï¸ LÃ¼tfen toplu nÃ¶betÃ§i verisini yapÄ±ÅŸtÄ±rÄ±n!");
        return;
      }

      const lines = bulkData.split('\n').map(line => line.trim()).filter(line => line);

      if (lines.length < 2) {
        alert("âš ï¸ En az bir baÅŸlÄ±k satÄ±rÄ± ve bir veri satÄ±rÄ± olmalÄ±!");
        return;
      }

      let imported = 0;
      let errors = 0;

      // Skip header line (index 0)
      for (let i = 1; i < lines.length; i++) {
        const parts = lines[i].split(',').map(p => p.trim());

        if (parts.length < 3) {
          errors++;
          continue;
        }

        const [date, dayInput = "", place, teacher] = parts;

        if (!date || !place || !teacher) {
          errors++;
          continue;
        }

        // Validate date format
        const dateObj = new Date(date);
        if (isNaN(dateObj.getTime())) {
          errors++;
          continue;
        }

        // Use provided day name or calculate it
        const day = dayInput || getTurkishDayName(date);

        dutyEntries.push({
          date,
          day,
          place,
          teacher
        });

        imported++;
      }

      document.getElementById("bulkDutyData").value = "";
      renderDutyTable();

      alert(`âœ… ${imported} nÃ¶betÃ§i kaydÄ± iÃ§e aktarÄ±ldÄ±!${errors > 0 ? `\nâš ï¸ ${errors} satÄ±r hatalÄ± olduÄŸu iÃ§in atlandÄ±.` : ''}\n\nDeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.`);
    }

    async function saveDutyData() {
      data.cards.dutyByDate = {
        items: dutyEntries
      };

      await saveData(data);
      alert(`âœ… NÃ¶betÃ§i Ã¶ÄŸretmen verileri kaydedildi!\n\nToplam ${dutyEntries.length} kayÄ±t bulunuyor.`);
    }

    // Initialize duty data on page load
    // MOVED TO DOMContentLoaded - initDutyData();

    // MOVED TO DOMContentLoaded
    // if (!data.cards.dutyByDate) {
    //   data.cards.dutyByDate = { items: [] };
    // }

    // MOVED TO DOMContentLoaded - document.getElementById("yksDate").value = data.cards.yks.date || "";

    // Media Center variables (global scope)
    var slideshowImages = [];
    var currentMediaType = 'slideshow';



    // MOVED TO DOMContentLoaded - document.getElementById("tText").value = data.cards.ticker.text || "";

    // Initialize ticker speed
    // MOVED TO DOMContentLoaded
    // const tickerSpeed = data.cards.ticker.speed || 20;
    // document.getElementById("tSpeed").value = tickerSpeed;
    // document.getElementById("tSpeedLabel").textContent = tickerSpeed;



    // Schedule Management
    let scheduleEntries = [];
    let currentScheduleDay = 'Pazartesi';

    // TimePlan Management (ders ve teneffÃ¼s saatleri)
    // MOVED TO DOMContentLoaded to prevent accessing undefined data.cards
    // if (!data.cards.timePlan) {
    //   data.cards.timePlan = { items: [] };
    // }
    let timePlanEntries = [];
    let currentTimePlanDay = 'Pazartesi';

    function loadScheduleEntries() {
      // Global data objesinin var olduÄŸundan emin ol
      if (!data) {
        data = {};
      }
      if (!data.cards) {
        data.cards = {};
      }

      if (!data.cards.schedule) {
        data.cards.schedule = { items: [] };
      }
      scheduleEntries = data.cards.schedule.items || [];

      // Migration: Add 'day' if missing for old data
      let modified = false;
      scheduleEntries.forEach(item => {
        if (!item.day) {
          item.day = 'Pazartesi';
          modified = true;
        }
      });
      if (modified) saveData(data);

      renderScheduleTable();
      updateDayButtons();
    }

    function setScheduleDay(day) {
      currentScheduleDay = day;
      updateDayButtons();
      renderScheduleTable();
    }

    function updateDayButtons() {
      document.querySelectorAll('.sch-day-btn').forEach(btn => {
        if (btn.dataset.day === currentScheduleDay) {
          btn.classList.add('bg-primary/10', 'text-primary', 'border-primary/20');
          btn.classList.remove('border-transparent');
        } else {
          btn.classList.remove('bg-primary/10', 'text-primary', 'border-primary/20');
          btn.classList.add('border-transparent');
        }
      });
    }

    function renderScheduleTable() {
      const tbody = document.getElementById("scheduleTableBody");
      const emptyMsg = document.getElementById("emptyScheduleMsg");
      tbody.innerHTML = "";

      // Filter entries by current selected day
      // Map to keep original index for deletion logic
      const filtered = scheduleEntries.map((item, index) => ({ ...item, originalIndex: index }))
        .filter(item => item.day === currentScheduleDay);

      if (filtered.length === 0) {
        emptyMsg.classList.remove('hidden');
      } else {
        emptyMsg.classList.add('hidden');
        filtered.forEach(entry => {
          const tr = document.createElement('tr');
          tr.className = "border-b border-slate-100 hover:bg-slate-50 transition-colors";
          tr.innerHTML = `
                <td class="p-3 font-semibold text-slate-700">${entry.cls || '-'}</td>
                <td class="p-3 text-slate-800">${entry.title || '-'}</td>
                <td class="p-3 text-slate-600">${entry.teacher || '-'}</td>
                <td class="p-3 font-mono text-sm text-slate-500">${entry.time || '-'}</td>
                <td class="p-3 text-right">
                    <button onclick="removeScheduleEntry(${entry.originalIndex})" class="text-red-500 hover:bg-red-50 p-2 rounded transition-colors" title="Sil">
                        <span class="material-symbols-outlined text-lg">delete</span>
                    </button>
                </td>
            `;
          tbody.appendChild(tr);
        });
      }
    }

    function addNewSchedule() {
      // Get values
      const day = document.getElementById('schDay').value;
      const cls = document.getElementById('schClass').value;
      const title = document.getElementById('schTitle').value;
      const teacher = document.getElementById('schTeacher').value;

      // Get time
      const sH = document.getElementById('startHour').value;
      const sM = document.getElementById('startMin').value;
      const eH = document.getElementById('endHour').value;
      const eM = document.getElementById('endMin').value;

      // Validation
      if (!cls || !title) {
        alert("âš ï¸ LÃ¼tfen en azÄ±ndan SÄ±nÄ±f ve Ders AdÄ± bilgilerini giriniz.");
        return;
      }

      const time = `${sH}:${sM}-${eH}:${eM}`;

      // Add to list
      scheduleEntries.push({
        day, cls, title, teacher, time
      });

      // Clear text inputs only (keep day and time for faster bulk entry)
      document.getElementById('schClass').value = '';
      document.getElementById('schTitle').value = '';
      document.getElementById('schTeacher').value = '';

      // Update view
      if (currentScheduleDay !== day) {
        setScheduleDay(day); // Switch to the day we just added to
      } else {
        renderScheduleTable();
      }

      // AUTO SAVE
      saveAllSchedules(true);
    }

    function removeScheduleEntry(index) {
      if (confirm("Bu dersi silmek istediÄŸinizden emin misiniz?")) {
        scheduleEntries.splice(index, 1);
        renderScheduleTable();

        // AUTO SAVE
        saveAllSchedules(true);
      }
    }

    function saveAllSchedules(silent = false) {
      // Sort logic could be added here (by day and time)
      data.cards.schedule.items = scheduleEntries;
      saveData(data);
      if (!silent) {
        alert("âœ… Ders programÄ± baÅŸarÄ±yla kaydedildi!");
      }
    }

    // Load schedule entries on page load
    loadScheduleEntries();

    // ==== TIME PLAN (LESSON & BREAK SLOTS) ====
    function setTimePlanDay(day) {
      currentTimePlanDay = day;
      const select = document.getElementById('tpDay');
      if (select && select.value !== day) {
        select.value = day;
      }
      renderTimePlanTable();
    }

    function renderTimePlanTable() {
      const tbody = document.getElementById('timePlanTableBody');
      const emptyMsg = document.getElementById('emptyTimePlanMsg');
      if (!tbody) return;

      tbody.innerHTML = '';

      const filtered = (timePlanEntries || []).map((item, index) => ({ ...item, originalIndex: index }))
        .filter(item => item.day === currentTimePlanDay);

      if (!filtered.length) {
        if (emptyMsg) emptyMsg.classList.remove('hidden');
        return;
      }
      if (emptyMsg) emptyMsg.classList.add('hidden');

      filtered.forEach(entry => {
        const tr = document.createElement('tr');
        tr.className = 'border-b border-slate-100 hover:bg-slate-50 transition-colors';
        tr.innerHTML = `
          <td class="p-2">
            <select class="input-field py-1 px-2 text-xs" onchange="updateTimePlanEntry(${entry.originalIndex}, 'type', this.value)">
              <option value="ders" ${entry.type === 'ders' ? 'selected' : ''}>Ders</option>
              <option value="teneffus" ${entry.type === 'teneffus' ? 'selected' : ''}>TeneffÃ¼s</option>
               <option value="ara" ${entry.type === 'ara' ? 'selected' : ''}>Ara</option>
            </select>
          </td>
          <td class="p-2">
            <input type="text" class="input-field py-1 px-2 text-xs" value="${entry.label || ''}"
                   onchange="updateTimePlanEntry(${entry.originalIndex}, 'label', this.value)" placeholder="Ã–rn: 1. Ders / 1. TeneffÃ¼s">
          </td>
          <td class="p-2">
            <input type="text" class="input-field py-1 px-2 font-mono text-xs" value="${entry.start || ''}"
                   onchange="updateTimePlanEntry(${entry.originalIndex}, 'start', this.value)" placeholder="08:30">
          </td>
          <td class="p-2">
            <input type="text" class="input-field py-1 px-2 font-mono text-xs" value="${entry.end || ''}"
                   onchange="updateTimePlanEntry(${entry.originalIndex}, 'end', this.value)" placeholder="09:10">
          </td>
          <td class="p-2 text-right">
            <button onclick="removeTimePlanRow(${entry.originalIndex})" class="text-red-500 hover:bg-red-50 p-2 rounded transition-colors" title="Sil">
              <span class="material-symbols-outlined text-lg">delete</span>
            </button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function addTimePlanRow() {
      const now = new Date();
      // Basit varsayÄ±lan saatler
      const defaultStart = '08:30';
      const defaultEnd = '09:10';

      timePlanEntries.push({
        day: currentTimePlanDay,
        type: 'ders',
        label: '',
        start: defaultStart,
        end: defaultEnd
      });

      renderTimePlanTable();
    }

    function updateTimePlanEntry(index, key, value) {
      if (!timePlanEntries[index]) return;
      timePlanEntries[index][key] = value;
    }

    function removeTimePlanRow(index) {
      if (!timePlanEntries[index]) return;
      if (!confirm('Bu satÄ±rÄ± silmek istediÄŸinizden emin misiniz?')) return;
      timePlanEntries.splice(index, 1);
      renderTimePlanTable();
    }

    function saveTimePlan() {
      // Basit doÄŸrulama: start/end boÅŸ olmayanlarÄ± al
      const cleaned = (timePlanEntries || []).filter(x => x.start && x.end && x.day);
      data.cards.timePlan.items = cleaned;
      saveData(data);
      alert('âœ… Ders ve teneffÃ¼s saatleri kaydedildi!');
    }

    // Ä°lk aÃ§Ä±lÄ±ÅŸta time plan tablosu iÃ§in varsayÄ±lan gÃ¼nÃ¼ yÃ¼kle
    setTimePlanDay(currentTimePlanDay);

    // Save functions
    async function saveSchoolName() {
      data.schoolName = document.getElementById("schoolName").value;

      // DEBUG: Veriyi kaydetmeden Ã¶nce kontrol et
      console.log('ğŸ” saveSchoolName - data objesi:', data);
      console.log('ğŸ” data.cards var mÄ±?', !!data.cards);
      console.log('ğŸ” data.cards iÃ§eriÄŸi:', data.cards);

      await saveData(data);
      alert("âœ… Okul adÄ± kaydedildi!");
    }

    async function saveDuty() {
      const lines = document.getElementById("dutyText").value.split("\n").filter(x => x.trim());
      data.cards.duty.list = lines.map(x => {
        const parts = x.split("|");
        return { place: parts[0]?.trim() || "", teacher: parts[1]?.trim() || "" };
      });
      await saveData(data);
      alert("âœ… NÃ¶betÃ§i Ã¶ÄŸretmenler kaydedildi!");
    }

    async function saveYKS() {
      // Global data objesinin var olduÄŸundan emin ol
      if (!data) {
        data = {};
      }
      if (!data.cards) {
        data.cards = {};
      }
      if (!data.cards.yks) {
        data.cards.yks = {};
      }

      data.cards.yks.enabled = document.getElementById("yksEnabled").checked;
      data.cards.yks.title = document.getElementById("yksTitle").value;
      data.cards.yks.date = document.getElementById("yksDate").value;
      await saveData(data);
      alert("âœ… YKS tarihi kaydedildi!");
    }
    function saveMedia() {
      data.cards.mainMedia.image = document.getElementById("mImage").value;
      data.cards.mainMedia.tag = document.getElementById("mTag").value;
      data.cards.mainMedia.title = document.getElementById("mTitle").value;
      data.cards.mainMedia.desc = document.getElementById("mDesc").value;
      saveData(data);
      alert("âœ… Ana gÃ¶rsel kaydedildi!");
    }



    function saveTicker() {
      data.cards.ticker.text = document.getElementById("tText").value;
      data.cards.ticker.speed = parseInt(document.getElementById("tSpeed").value);
      saveData(data);
      alert("âœ… Kayan yazÄ± kaydedildi!");
    }

    function updateTickerSpeedLabel() {
      const speed = document.getElementById("tSpeed").value;
      document.getElementById("tSpeedLabel").textContent = speed;
    }

    async function showRawData() {
      const currentData = await loadData();
      const jsonStr = JSON.stringify(currentData, null, 2);
      document.getElementById('rawDataOutput').value = jsonStr;
    }

    function importRawData() {
      const rawText = document.getElementById('rawDataOutput').value;
      if (!rawText.trim()) {
        alert("âš ï¸ LÃ¼tfen geÃ§erli bir JSON verisi giriniz.");
        return;
      }

      try {
        const newData = JSON.parse(rawText);
        // Basic validation
        if (!newData.cards) {
          throw new Error("GeÃ§ersiz veri formatÄ±: 'cards' objesi eksik.");
        }

        if (confirm("âš ï¸ DÄ°KKAT: Mevcut tÃ¼m veriler silinecek ve bu yeni verilerle deÄŸiÅŸtirilecek. Emin misiniz?")) {
          saveData(newData);
          alert("âœ… Veriler baÅŸarÄ±yla iÃ§e aktarÄ±ldÄ±! Sayfa yenileniyor...");
          location.reload();
        }
      } catch (e) {
        alert("âŒ HATA: GeÃ§ersiz JSON formatÄ±!\n\nDetay: " + e.message);
      }
    }

    // ===== MEDIA CENTER MANAGEMENT =====
    // Variables are now in global scope above

    function setMediaType(type) {
      currentMediaType = type;

      // Update button states
      document.querySelectorAll('.media-type-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      document.getElementById(`btn-media-${type}`).classList.add('active');

      // Show/hide settings
      document.querySelectorAll('.media-settings').forEach(settings => {
        settings.classList.add('hidden');
      });
      document.getElementById(`media-${type}-settings`).classList.remove('hidden');
    }

    function addSlideshowImage() {
      slideshowImages.push({
        path: '',
        alt: '',
        showOverlay: false,
        tag: '',
        title: '',
        desc: ''
      });
      renderSlideshowImages();
    }

    function removeSlideshowImage(index) {
      slideshowImages.splice(index, 1);
      renderSlideshowImages();
    }

    function updateSlideshowImage(index, field, value) {
      slideshowImages[index][field] = value;
    }

    function renderSlideshowImages() {
      const container = document.getElementById('slideshow-images-container');
      if (!container) return;

      container.innerHTML = '';

      if (slideshowImages.length === 0) {
        container.innerHTML = '<p class="text-xs text-gray-400 text-center italic py-4">HenÃ¼z resim eklenmemiÅŸ.</p>';
        return;
      }

      slideshowImages.forEach((img, index) => {
        const div = document.createElement('div');
        div.className = 'bg-slate-50 p-4 rounded-lg border border-slate-200';

        // Ensure overlay fields exist
        if (img.showOverlay === undefined) img.showOverlay = false;
        if (img.tag === undefined) img.tag = '';
        if (img.title === undefined) img.title = '';
        if (img.desc === undefined) img.desc = '';

        // Resim Ã¶nizlemesi (eÄŸer path varsa)
        const imagePreview = img.path ? `
          <div class="mb-3">
            <img src="${img.path}" alt="${img.alt || 'Ã–nizleme'}" 
              class="w-full h-32 object-cover rounded-lg border border-slate-300"
              onerror="this.style.display='none'">
          </div>
        ` : '';

        div.innerHTML = `
          ${imagePreview}
          <div class="flex gap-2 items-start mb-3">
            <div class="flex-1 space-y-2">
              <div>
                <label class="text-xs font-semibold text-gray-600 mb-1 block">Resim Yolu</label>
                <div class="flex gap-2">
                  <input type="text" id="img-path-${index}" class="input-field p-2 text-sm flex-1" value="${img.path || ''}" 
                    onchange="updateSlideshowImage(${index}, 'path', this.value)" 
                    placeholder="images/photo.jpg veya https://...">
                  <label class="cursor-pointer bg-primary text-white px-3 py-2 rounded-lg hover:bg-primary-dark transition-colors flex items-center gap-1 text-sm font-semibold whitespace-nowrap">
                    <span class="material-symbols-outlined text-lg">upload</span>
                    YÃ¼kle
                    <input type="file" accept="image/*" class="hidden" onchange="uploadImageToFirebase(this, ${index})">
                  </label>
                </div>
                <div id="upload-progress-${index}" class="hidden mt-2">
                  <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="upload-bar-${index}" class="bg-primary h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                  </div>
                  <p id="upload-status-${index}" class="text-xs text-gray-500 mt-1">YÃ¼kleniyor...</p>
                </div>
              </div>
              <div>
                <label class="text-xs font-semibold text-gray-600 mb-1 block">Resim AÃ§Ä±klamasÄ± (Alt Text)</label>
                <input type="text" class="input-field p-2 text-sm" value="${img.alt || ''}" 
                  onchange="updateSlideshowImage(${index}, 'alt', this.value)" 
                  placeholder="Resim aÃ§Ä±klamasÄ± (opsiyonel)">
              </div>
            </div>
            <button onclick="removeSlideshowImage(${index})" 
              class="text-red-500 hover:text-red-700 bg-white p-2 border border-slate-200 rounded flex-shrink-0">
              <span class="material-symbols-outlined text-lg">delete</span>
            </button>
          </div>
          
          <!-- Bilgi KatmanÄ± SeÃ§eneÄŸi -->
          <div class="border-t border-slate-300 pt-3 mt-2">
            <label class="flex items-center gap-2 mb-2 cursor-pointer">
              <input type="checkbox" 
                class="accent-primary cursor-pointer" 
                ${img.showOverlay ? 'checked' : ''}
                onchange="toggleImageOverlay(${index}, this.checked)">
              <span class="text-sm font-semibold text-gray-700">Bu resim iÃ§in bilgi katmanÄ± gÃ¶ster</span>
            </label>
            
            <div id="overlay-fields-${index}" class="ml-6 space-y-2 ${img.showOverlay ? '' : 'hidden'}">
              <div>
                <label class="text-xs font-semibold text-gray-600 mb-1 block">Etiket/Badge</label>
                <input type="text" class="input-field p-2 text-sm" value="${img.tag || ''}" 
                  onchange="updateSlideshowImage(${index}, 'tag', this.value)" 
                  placeholder="Ã–rn: DUYURU, ETKÄ°NLÄ°K">
              </div>
              <div>
                <label class="text-xs font-semibold text-gray-600 mb-1 block">BaÅŸlÄ±k</label>
                <input type="text" class="input-field p-2 text-sm" value="${img.title || ''}" 
                  onchange="updateSlideshowImage(${index}, 'title', this.value)" 
                  placeholder="Etkinlik veya duyuru baÅŸlÄ±ÄŸÄ±">
              </div>
              <div>
                <label class="text-xs font-semibold text-gray-600 mb-1 block">AÃ§Ä±klama</label>
                <textarea rows="2" class="input-field p-2 text-sm" 
                  onchange="updateSlideshowImage(${index}, 'desc', this.value)" 
                  placeholder="KÄ±sa aÃ§Ä±klama veya detay">${img.desc || ''}</textarea>
              </div>
            </div>
          </div>
        `;
        container.appendChild(div);
      });
    }

    // GitHub API ile resim yÃ¼kleme fonksiyonu
    async function uploadImageToFirebase(inputElement, index) {
      const file = inputElement.files[0];
      if (!file) return;

      // Dosya tipi kontrolÃ¼
      if (!file.type.startsWith('image/')) {
        alert('âŒ LÃ¼tfen sadece resim dosyasÄ± seÃ§in!');
        return;
      }

      // Dosya boyutu kontrolÃ¼ (max 5MB - GitHub limiti)
      const maxSize = 5 * 1024 * 1024; // 5MB
      if (file.size > maxSize) {
        alert('âŒ Dosya boyutu Ã§ok bÃ¼yÃ¼k! Maksimum 5MB olmalÄ±dÄ±r.');
        return;
      }

      // GitHub token kontrolÃ¼
      let githubToken = localStorage.getItem('github_token');
      if (!githubToken) {
        githubToken = prompt('GitHub Personal Access Token giriniz:\n\n(Token\'Ä± GitHub Settings â†’ Developer settings â†’ Personal access tokens bÃ¶lÃ¼mÃ¼nden oluÅŸturabilirsiniz.\n\nGerekli izin: repo)');
        if (!githubToken) {
          alert('âŒ GitHub token gerekli!');
          return;
        }
        localStorage.setItem('github_token', githubToken);
      }

      // Progress bar'Ä± gÃ¶ster
      const progressContainer = document.getElementById(`upload-progress-${index}`);
      const progressBar = document.getElementById(`upload-bar-${index}`);
      const statusText = document.getElementById(`upload-status-${index}`);
      progressContainer.classList.remove('hidden');
      progressBar.style.width = '10%';
      statusText.textContent = 'Dosya hazÄ±rlanÄ±yor...';

      try {
        // DosyayÄ± base64'e Ã§evir
        const base64Content = await fileToBase64(file);
        progressBar.style.width = '30%';
        statusText.textContent = 'GitHub\'a yÃ¼kleniyor...';

        // Dosya adÄ±nÄ± sanitize et
        const timestamp = Date.now();
        const sanitizedFileName = file.name.replace(/[^a-zA-Z0-9.-]/g, '_');
        const fileName = `${timestamp}_${sanitizedFileName}`;
        const filePath = `images/${fileName}`;

        // GitHub API ayarlarÄ±
        const owner = 'zeyn-el';  // GitHub kullanÄ±cÄ± adÄ±nÄ±z
        const repo = 'dijital-okul-pano-iyfl';  // Repo adÄ±nÄ±z
        const branch = 'main';

        // GitHub API'ye yÃ¼kleme isteÄŸi
        const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`, {
          method: 'PUT',
          headers: {
            'Authorization': `token ${githubToken}`,
            'Content-Type': 'application/json',
            'Accept': 'application/vnd.github.v3+json'
          },
          body: JSON.stringify({
            message: `ğŸ“· Resim eklendi: ${fileName}`,
            content: base64Content,
            branch: branch
          })
        });

        progressBar.style.width = '80%';

        if (!response.ok) {
          const errorData = await response.json();

          // Token hatalÄ±ysa sil ve tekrar sor
          if (response.status === 401) {
            localStorage.removeItem('github_token');
            throw new Error('Token geÃ§ersiz veya sÃ¼resi dolmuÅŸ. LÃ¼tfen tekrar deneyin.');
          }

          throw new Error(errorData.message || 'GitHub API hatasÄ±');
        }

        const result = await response.json();
        progressBar.style.width = '100%';

        // GitHub Pages URL'si oluÅŸtur
        const imageUrl = `https://zeyn-el.github.io/dijital-okul-pano-iyfl/${filePath}`;

        // Alternatif: Raw GitHub URL (anÄ±nda eriÅŸilebilir)
        const rawUrl = `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${filePath}`;

        // Resim yolunu gÃ¼ncelle (raw URL kullan - anÄ±nda eriÅŸilebilir)
        slideshowImages[index].path = rawUrl;
        document.getElementById(`img-path-${index}`).value = rawUrl;

        statusText.textContent = 'âœ… GitHub\'a yÃ¼klendi!';
        statusText.className = 'text-xs text-green-500 mt-1';

        // 1.5 saniye sonra Ã¶nizlemeyi gÃ¼ncelle
        setTimeout(() => {
          renderSlideshowImages();
        }, 1500);

      } catch (error) {
        console.error('GitHub upload error:', error);
        progressBar.style.width = '0%';
        statusText.textContent = 'âŒ YÃ¼kleme hatasÄ±!';
        statusText.className = 'text-xs text-red-500 mt-1';
        alert('âŒ GitHub\'a yÃ¼klenirken hata oluÅŸtu:\n\n' + error.message);
      }
    }

    // DosyayÄ± base64'e Ã§evirme yardÄ±mcÄ± fonksiyonu
    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
          // "data:image/jpeg;base64," kÄ±smÄ±nÄ± Ã§Ä±kar
          const base64 = reader.result.split(',')[1];
          resolve(base64);
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    // GitHub token'Ä± temizleme fonksiyonu (gerekirse)
    function clearGitHubToken() {
      localStorage.removeItem('github_token');
      alert('âœ… GitHub token temizlendi. Sonraki yÃ¼klemede tekrar sorulacak.');
    }

    function updateSlideshowSpeedLabel() {
      const speed = document.getElementById('slideshowSpeed').value;
      const label = document.getElementById('slideshowSpeedLabel');
      if (label) label.textContent = speed;
    }

    function toggleImageOverlay(index, checked) {
      slideshowImages[index].showOverlay = checked;
      const overlayFields = document.getElementById(`overlay-fields-${index}`);
      if (overlayFields) {
        if (checked) {
          overlayFields.classList.remove('hidden');
        } else {
          overlayFields.classList.add('hidden');
        }
      }
    }

    function loadMediaCenterData() {
      const mediaData = data.cards.mediaCenter || {};

      // Set media type
      const mediaType = mediaData.type || 'slideshow';
      setMediaType(mediaType);

      // Fullscreen
      const fullscreenCheckbox = document.getElementById('mediaFullscreen');
      if (fullscreenCheckbox) {
        fullscreenCheckbox.checked = mediaData.fullscreen || false;
      }

      // Slideshow
      if (mediaData.slideshow) {
        slideshowImages = mediaData.slideshow.images || [];
        renderSlideshowImages();

        const speedInput = document.getElementById('slideshowSpeed');
        const speedLabel = document.getElementById('slideshowSpeedLabel');
        if (speedInput) speedInput.value = mediaData.slideshow.speed || 5;
        if (speedLabel) speedLabel.textContent = mediaData.slideshow.speed || 5;
      }

      // Video
      if (mediaData.video) {
        const videoUrl = document.getElementById('videoUrl');
        const videoAutoplay = document.getElementById('videoAutoplay');
        const videoLoop = document.getElementById('videoLoop');
        const videoMuted = document.getElementById('videoMuted');

        if (videoUrl) videoUrl.value = mediaData.video.url || '';
        if (videoAutoplay) videoAutoplay.checked = mediaData.video.autoplay || false;
        if (videoLoop) videoLoop.checked = mediaData.video.loop || false;
        if (videoMuted) videoMuted.checked = mediaData.video.muted || false;
      }

      // Webpage
      if (mediaData.webpage) {
        const webpageUrl = document.getElementById('webpageUrl');
        if (webpageUrl) webpageUrl.value = mediaData.webpage.url || '';
      }
    }

    function saveMediaCenter() {
      if (!data.cards.mediaCenter) {
        data.cards.mediaCenter = {};
      }

      data.cards.mediaCenter.type = currentMediaType;
      data.cards.mediaCenter.fullscreen = document.getElementById('mediaFullscreen').checked;

      // Save slideshow data
      data.cards.mediaCenter.slideshow = {
        images: slideshowImages.filter(img => img.path.trim() !== ''),
        speed: parseInt(document.getElementById('slideshowSpeed').value)
      };

      // Save video data
      data.cards.mediaCenter.video = {
        url: document.getElementById('videoUrl').value,
        autoplay: document.getElementById('videoAutoplay').checked,
        loop: document.getElementById('videoLoop').checked,
        muted: document.getElementById('videoMuted').checked
      };

      // Save webpage data
      data.cards.mediaCenter.webpage = {
        url: document.getElementById('webpageUrl').value
      };

      saveData(data);
      alert('âœ… Medya merkezi ayarlarÄ± kaydedildi!');
    }

    // ===== QUOTE MANAGEMENT =====
    var quotesList = [];

    async function initQuoteData() {
      console.log('ğŸ’¬ initQuoteData baÅŸladÄ±...');

      // Global data objesinin var olduÄŸundan emin ol
      if (!data) {
        data = {};
      }
      if (!data.cards) {
        data.cards = {};
      }

      try {
        // DoÄŸrudan Firebase'den Ã§ek
        const snapshot = await firebase.database().ref('panoData/cards/quotes').once('value');
        const quotesData = snapshot.val();

        console.log('ğŸ’¬ Firebase\'den Ã§ekilen quotesData:', quotesData);

        if (!quotesData) {
          console.log('ğŸ’¬ Firebase\'de quotes verisi yok, boÅŸ baÅŸlatÄ±lÄ±yor...');
          data.cards.quotes = {
            title: "GÃ¼nÃ¼n SÃ¶zÃ¼",
            enableSlider: false,
            sliderSpeed: 8,
            maxSlides: 5,
            items: []
          };
          quotesList = [];
          document.getElementById("quoteCardTitle").value = "GÃ¼nÃ¼n SÃ¶zÃ¼";
          document.getElementById("enableQuoteSlider").checked = false;
          document.getElementById("quoteSliderSpeed").value = 8;
          document.getElementById("quoteMaxSlides").value = 5;
          toggleQuoteSliderSettings();
          renderQuoteTable();
          return;
        }

        // Global data objesini gÃ¼ncelle
        data.cards.quotes = quotesData;

        // items verisini al
        let itemsData = quotesData.items;
        console.log('ğŸ’¬ itemsData raw:', itemsData);

        // Firebase'de array veriler bazen object olarak saklanabilir
        if (itemsData && typeof itemsData === 'object' && !Array.isArray(itemsData)) {
          console.log('ğŸ’¬ Object -> Array dÃ¶nÃ¼ÅŸÃ¼mÃ¼ yapÄ±lÄ±yor...');
          itemsData = Object.values(itemsData);
          data.cards.quotes.items = itemsData;
        }

        quotesList = itemsData || [];
        console.log('ğŸ’¬ quotesList final length:', quotesList.length);

        // UI gÃ¼ncelle
        document.getElementById("quoteCardTitle").value = quotesData.title || "GÃ¼nÃ¼n SÃ¶zÃ¼";
        document.getElementById("enableQuoteSlider").checked = quotesData.enableSlider || false;
        document.getElementById("quoteSliderSpeed").value = quotesData.sliderSpeed || 8;
        document.getElementById("quoteMaxSlides").value = quotesData.maxSlides || 5;

        toggleQuoteSliderSettings();
        renderQuoteTable();
        console.log('ğŸ’¬ initQuoteData tamamlandÄ± - ' + quotesList.length + ' sÃ¶z yÃ¼klendi');

      } catch (error) {
        console.error('ğŸ’¬ initQuoteData HATA:', error);
        quotesList = [];
        renderQuoteTable();
      }
    }

    function addManualQuote() {
      const text = document.getElementById("manualQuoteText").value.trim();
      const author = document.getElementById("manualQuoteAuthor").value.trim();
      const date = document.getElementById("manualQuoteDate").value;

      if (!text || !author) {
        alert("âš ï¸ LÃ¼tfen en azÄ±ndan SÃ¶z ve Yazar alanlarÄ±nÄ± doldurun!");
        return;
      }

      quotesList.push({
        text,
        author,
        date: date || null
      });

      // Clear form
      document.getElementById("manualQuoteText").value = "";
      document.getElementById("manualQuoteAuthor").value = "";
      document.getElementById("manualQuoteDate").value = "";

      renderQuoteTable();
      alert("âœ… SÃ¶z eklendi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
    }

    function importBulkQuotes() {
      const bulkData = document.getElementById("bulkQuoteData").value.trim();

      if (!bulkData) {
        alert("âš ï¸ LÃ¼tfen toplu sÃ¶z verisini yapÄ±ÅŸtÄ±rÄ±n!");
        return;
      }

      const lines = bulkData.split('\n').map(line => line.trim()).filter(line => line);

      if (lines.length < 2) {
        alert("âš ï¸ En az bir baÅŸlÄ±k satÄ±rÄ± ve bir veri satÄ±rÄ± olmalÄ±!");
        return;
      }

      let imported = 0;
      let errors = 0;

      // Skip header line (index 0)
      for (let i = 1; i < lines.length; i++) {
        const parts = lines[i].split('|').map(p => p.trim());

        if (parts.length < 2) {
          errors++;
          continue;
        }

        const [text, author, date = null] = parts;

        if (!text || !author) {
          errors++;
          continue;
        }

        quotesList.push({
          text,
          author,
          date: date || null
        });

        imported++;
      }

      document.getElementById("bulkQuoteData").value = "";
      renderQuoteTable();

      alert(`âœ… ${imported} sÃ¶z iÃ§e aktarÄ±ldÄ±!${errors > 0 ? `\nâš ï¸ ${errors} satÄ±r hatalÄ± olduÄŸu iÃ§in atlandÄ±.` : ''}\n\nDeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.`);
    }

    function toggleQuoteSliderSettings() {
      const enabled = document.getElementById("enableQuoteSlider").checked;
      const settings = document.getElementById("quoteSliderSettings");

      if (enabled) {
        settings.classList.remove("hidden");
      } else {
        settings.classList.add("hidden");
      }
    }

    function renderQuoteTable() {
      const tbody = document.getElementById("quoteTableBody");
      const emptyMsg = document.getElementById("emptyQuoteMsg");
      const quoteCount = document.getElementById("quoteCount");

      tbody.innerHTML = "";
      quoteCount.textContent = `(${quotesList.length} sÃ¶z)`;

      if (quotesList.length === 0) {
        emptyMsg.classList.remove("hidden");
        return;
      }

      emptyMsg.classList.add("hidden");

      quotesList.forEach((quote, index) => {
        const tr = document.createElement("tr");
        tr.className = "border-b border-slate-100 hover:bg-slate-50 transition-colors";
        tr.id = `quote-row-${index}`;

        const truncatedText = quote.text.length > 60 ? quote.text.substring(0, 60) + "..." : quote.text;
        const dateDisplay = quote.date || "-";

        tr.innerHTML = `
          <td class="p-3 font-semibold text-slate-700">${index + 1}</td>
          <td class="p-3 text-slate-800" title="${quote.text}">${truncatedText}</td>
          <td class="p-3 text-slate-600">${quote.author}</td>
          <td class="p-3 font-mono text-sm text-slate-500">${dateDisplay}</td>
          <td class="p-3 text-right">
            <button onclick="editQuote(${index})" 
              class="text-blue-500 hover:bg-blue-50 p-2 rounded transition-colors mr-1" title="DÃ¼zenle">
              <span class="material-symbols-outlined text-lg">edit</span>
            </button>
            <button onclick="removeQuote(${index})" 
              class="text-red-500 hover:bg-red-50 p-2 rounded transition-colors" title="Sil">
              <span class="material-symbols-outlined text-lg">delete</span>
            </button>
          </td>
        `;

        tbody.appendChild(tr);
      });
    }

    function editQuote(index) {
      const quote = quotesList[index];
      const row = document.getElementById(`quote-row-${index}`);

      row.innerHTML = `
        <td class="p-3 font-semibold text-slate-700">${index + 1}</td>
        <td class="p-3">
          <textarea id="edit-quote-text-${index}" rows="2" 
            class="input-field p-2 text-sm w-full">${quote.text}</textarea>
        </td>
        <td class="p-3">
          <input type="text" id="edit-quote-author-${index}" value="${quote.author}" 
            class="input-field p-2 text-sm w-full">
        </td>
        <td class="p-3">
          <input type="date" id="edit-quote-date-${index}" value="${quote.date || ''}" 
            class="input-field p-2 text-sm w-full">
        </td>
        <td class="p-3 text-right">
          <button onclick="saveEditQuote(${index})" 
            class="text-green-500 hover:bg-green-50 p-2 rounded transition-colors mr-1" title="Kaydet">
            <span class="material-symbols-outlined text-lg">check</span>
          </button>
          <button onclick="renderQuoteTable()" 
            class="text-gray-500 hover:bg-gray-50 p-2 rounded transition-colors" title="Ä°ptal">
            <span class="material-symbols-outlined text-lg">close</span>
          </button>
        </td>
      `;
    }

    function saveEditQuote(index) {
      const text = document.getElementById(`edit-quote-text-${index}`).value.trim();
      const author = document.getElementById(`edit-quote-author-${index}`).value.trim();
      const date = document.getElementById(`edit-quote-date-${index}`).value || null;

      if (!text || !author) {
        alert("âš ï¸ LÃ¼tfen SÃ¶z ve Yazar alanlarÄ±nÄ± doldurun!");
        return;
      }

      quotesList[index] = { text, author, date };
      renderQuoteTable();
      alert("âœ… SÃ¶z gÃ¼ncellendi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
    }

    function removeQuote(index) {
      if (confirm("Bu sÃ¶zÃ¼ silmek istediÄŸinizden emin misiniz?")) {
        quotesList.splice(index, 1);
        renderQuoteTable();
        alert("âœ… SÃ¶z silindi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
      }
    }

    function clearAllQuotes() {
      if (confirm("âš ï¸ TÃœM sÃ¶z kayÄ±tlarÄ±nÄ± silmek istediÄŸinizden emin misiniz?\n\nBu iÅŸlem geri alÄ±namaz!")) {
        if (confirm("Son kez soruyoruz: TÃ¼m kayÄ±tlar silinecek, emin misiniz?")) {
          quotesList = [];
          renderQuoteTable();
          alert("âœ… TÃ¼m kayÄ±tlar silindi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
        }
      }
    }

    function saveQuoteData() {
      // Global data objesinin var olduÄŸundan emin ol
      if (!data) {
        data = {};
      }
      if (!data.cards) {
        data.cards = {};
      }

      const sliderSpeed = parseInt(document.getElementById("quoteSliderSpeed").value) || 8;
      const maxSlides = parseInt(document.getElementById("quoteMaxSlides").value) || 5;

      data.cards.quotes = {
        title: document.getElementById("quoteCardTitle").value,
        enableSlider: document.getElementById("enableQuoteSlider").checked,
        sliderSpeed: sliderSpeed,
        maxSlides: maxSlides,
        items: quotesList
      };

      console.log('ğŸ’¬ saveQuoteData - Kaydedilen veri:', data.cards.quotes);
      console.log('ğŸ’¬ sliderSpeed:', sliderSpeed, 'maxSlides:', maxSlides);

      saveData(data);
      alert(`âœ… GÃ¼nÃ¼n sÃ¶zÃ¼ verileri kaydedildi!\n\nToplam ${quotesList.length} sÃ¶z kaydÄ±\nSlider: ${data.cards.quotes.enableSlider ? 'AÃ§Ä±k' : 'KapalÄ±'}\nGÃ¶sterim sÃ¼resi: ${sliderSpeed} saniye\nMaks. slayt: ${maxSlides}`);
    }

    // Initialize quote data on page load
    // MOVED TO DOMContentLoaded - initQuoteData();

    // ===== INFO CARD MANAGEMENT =====
    let infoList = [];

    function initInfoData() {
      // Load existing info data
      if (data.cards && data.cards.info) {
        infoList = data.cards.info.items || [];
        document.getElementById("infoEnabled").checked = data.cards.info.enabled || false;
        document.getElementById("infoSliderSpeed").value = data.cards.info.sliderSpeed || 5;

        // Kart rengini yÃ¼kle
        const cardColor = data.cards.info.cardColor || '#2b8cee';
        document.getElementById("infoCardColorInput").value = cardColor;
        document.getElementById("infoCardColorPreview").style.background = cardColor;
      }

      renderInfoTable();

      // Add first entry row if empty
      if (infoList.length === 0) {
        addInfoEntryRow();
      }
    }

    function addInfoEntryRow() {
      const container = document.getElementById("infoEntriesContainer");
      const rowId = `info-row-${Date.now()}`;

      const row = document.createElement("div");
      row.id = rowId;
      row.className = "p-4 bg-white rounded-lg border border-slate-200";
      row.innerHTML = `
        <div class="grid grid-cols-1 gap-3">
          <div>
            <label class="input-label text-sm">BaÅŸlÄ±k</label>
            <input type="text" class="input-field p-2 text-sm info-title" placeholder="Ã–rn: HaftanÄ±n SÄ±nÄ±fÄ±">
          </div>
          <div>
            <label class="input-label text-sm">Detay</label>
            <input type="text" class="input-field p-2 text-sm info-detail" placeholder="Ã–rn: 10-B">
          </div>
          <div>
            <label class="input-label text-sm">Not</label>
            <input type="text" class="input-field p-2 text-sm info-note" placeholder="Ã–rn: En iyi ders dinleyen sÄ±nÄ±f. Tebrikler!">
          </div>
          <div class="flex gap-2">
            <button onclick="addInfoFromRow('${rowId}')" class="btn-save flex-1">
              <span class="material-symbols-outlined text-sm mr-1">add</span>
              Listeye Ekle
            </button>
            <button onclick="removeInfoRow('${rowId}')" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-bold">
              <span class="material-symbols-outlined text-sm">close</span>
            </button>
          </div>
        </div>
      `;

      container.appendChild(row);
    }

    function removeInfoRow(rowId) {
      const row = document.getElementById(rowId);
      if (row) {
        row.remove();
      }
    }

    function addInfoFromRow(rowId) {
      const row = document.getElementById(rowId);
      if (!row) return;

      const title = row.querySelector(".info-title").value.trim();
      const detail = row.querySelector(".info-detail").value.trim();
      const note = row.querySelector(".info-note").value.trim();

      if (!title || !detail) {
        alert("âš ï¸ LÃ¼tfen en az BaÅŸlÄ±k ve Detay alanlarÄ±nÄ± doldurun!");
        return;
      }

      infoList.push({ title, detail, note });

      // Clear form
      row.querySelector(".info-title").value = "";
      row.querySelector(".info-detail").value = "";
      row.querySelector(".info-note").value = "";

      renderInfoTable();
      alert("âœ… Bilgi listeye eklendi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
    }

    function renderInfoTable() {
      const tbody = document.getElementById("infoTableBody");
      const emptyMsg = document.getElementById("emptyInfoMsg");
      const infoCount = document.getElementById("infoCount");

      tbody.innerHTML = "";
      infoCount.textContent = `(${infoList.length} kayÄ±t)`;

      if (infoList.length === 0) {
        emptyMsg.classList.remove("hidden");
        return;
      }

      emptyMsg.classList.add("hidden");

      infoList.forEach((info, index) => {
        const tr = document.createElement("tr");
        tr.className = "border-b border-slate-100 hover:bg-slate-50 transition-colors";
        tr.id = `info-row-${index}`;

        tr.innerHTML = `
          <td class="p-3 font-semibold text-slate-700">${index + 1}</td>
          <td class="p-3 text-slate-800" id="info-title-${index}">${info.title}</td>
          <td class="p-3 text-slate-600" id="info-detail-${index}">${info.detail}</td>
          <td class="p-3 text-slate-500 text-sm" id="info-note-${index}">${info.note || '-'}</td>
          <td class="p-3 text-right">
            <button onclick="editInfo(${index})" 
              class="text-blue-500 hover:bg-blue-50 p-2 rounded transition-colors mr-1" title="DÃ¼zenle">
              <span class="material-symbols-outlined text-lg">edit</span>
            </button>
            <button onclick="removeInfo(${index})" 
              class="text-red-500 hover:bg-red-50 p-2 rounded transition-colors" title="Sil">
              <span class="material-symbols-outlined text-lg">delete</span>
            </button>
          </td>
        `;

        tbody.appendChild(tr);
      });
    }

    function editInfo(index) {
      const info = infoList[index];
      const row = document.getElementById(`info-row-${index}`);

      // Replace row with editable inputs
      row.innerHTML = `
        <td class="p-3 font-semibold text-slate-700">${index + 1}</td>
        <td class="p-3">
          <input type="text" id="edit-info-title-${index}" value="${info.title}" 
            class="input-field p-2 text-sm w-full">
        </td>
        <td class="p-3">
          <input type="text" id="edit-info-detail-${index}" value="${info.detail}" 
            class="input-field p-2 text-sm w-full">
        </td>
        <td class="p-3">
          <input type="text" id="edit-info-note-${index}" value="${info.note || ''}" 
            class="input-field p-2 text-sm w-full">
        </td>
        <td class="p-3 text-right">
          <button onclick="saveEditInfo(${index})" 
            class="text-green-500 hover:bg-green-50 p-2 rounded transition-colors mr-1" title="Kaydet">
            <span class="material-symbols-outlined text-lg">check</span>
          </button>
          <button onclick="renderInfoTable()" 
            class="text-gray-500 hover:bg-gray-50 p-2 rounded transition-colors" title="Ä°ptal">
            <span class="material-symbols-outlined text-lg">close</span>
          </button>
        </td>
      `;
    }

    function saveEditInfo(index) {
      const title = document.getElementById(`edit-info-title-${index}`).value.trim();
      const detail = document.getElementById(`edit-info-detail-${index}`).value.trim();
      const note = document.getElementById(`edit-info-note-${index}`).value.trim();

      if (!title || !detail) {
        alert("âš ï¸ LÃ¼tfen en az BaÅŸlÄ±k ve Detay alanlarÄ±nÄ± doldurun!");
        return;
      }

      infoList[index] = { title, detail, note };
      renderInfoTable();
      alert("âœ… Bilgi gÃ¼ncellendi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
    }

    function removeInfo(index) {
      if (confirm("Bu bilgiyi silmek istediÄŸinizden emin misiniz?")) {
        infoList.splice(index, 1);
        renderInfoTable();
        alert("âœ… Bilgi silindi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
      }
    }

    function clearAllInfos() {
      if (confirm("âš ï¸ TÃœM bilgi kayÄ±tlarÄ±nÄ± silmek istediÄŸinizden emin misiniz?\n\nBu iÅŸlem geri alÄ±namaz!")) {
        if (confirm("Son kez soruyoruz: TÃ¼m kayÄ±tlar silinecek, emin misiniz?")) {
          infoList = [];
          renderInfoTable();
          alert("âœ… TÃ¼m kayÄ±tlar silindi! DeÄŸiÅŸiklikleri kaydetmeyi unutmayÄ±n.");
        }
      }
    }

    // YKS SayaÃ§ Kaydetme
    function saveYKS() {
      // Global data objesinin var olduÄŸundan emin ol
      if (!data) {
        data = {};
      }
      if (!data.cards) {
        data.cards = {};
      }

      const yksEnabled = document.getElementById("yksEnabled").checked;
      const yksTitle = document.getElementById("yksTitle").value.trim() || "YKS'ye Kalan";
      const yksDate = document.getElementById("yksDate").value;

      data.cards.yks = {
        enabled: yksEnabled,
        title: yksTitle,
        date: yksDate
      };

      saveData(data);
      alert(`âœ… YKS SayaÃ§ verileri kaydedildi!\n\nBaÅŸlÄ±k: ${yksTitle}\nTarih: ${yksDate || 'BelirtilmemiÅŸ'}\nDurum: ${yksEnabled ? 'GÃ¶steriliyor' : 'Gizli'}`);
    }

    function saveInfoData() {
      data.cards.info = {
        enabled: document.getElementById("infoEnabled").checked,
        sliderSpeed: parseInt(document.getElementById("infoSliderSpeed").value),
        cardColor: document.getElementById("infoCardColorInput").value || '',
        items: infoList
      };

      saveData(data);
      alert(`âœ… Bilgi kartÄ± verileri kaydedildi!\n\nToplam ${infoList.length} bilgi kaydÄ± bulunuyor.\nKart durumu: ${data.cards.info.enabled ? 'Aktif' : 'Pasif'}\nKart rengi: ${data.cards.info.cardColor || 'VarsayÄ±lan (Mavi)'}`);
    }

    // Bilgi kartÄ± renk seÃ§imi
    function setInfoCardColor(color) {
      const input = document.getElementById('infoCardColorInput');
      const preview = document.getElementById('infoCardColorPreview');

      if (input) input.value = color;
      if (preview) preview.style.background = color;

      // TÃ¼m renk butonlarÄ±ndan seÃ§ili iÅŸaretini kaldÄ±r
      document.querySelectorAll('.info-color-btn').forEach(btn => {
        btn.classList.remove('ring-2', 'ring-offset-2', 'ring-purple-500');
      });

      // TÄ±klanan butona seÃ§ili iÅŸareti ekle (event varsa)
      if (event && event.target) {
        event.target.classList.add('ring-2', 'ring-offset-2', 'ring-purple-500');
      }
    }

    // YKS ve DoÄŸum GÃ¼nÃ¼ verilerini yÃ¼kle
    function loadYKSAndBirthdayData() {
      // YKS verilerini yÃ¼kle
      if (data.cards.yks) {
        document.getElementById("yksEnabled").checked = data.cards.yks.enabled !== false; // Default true
        document.getElementById("yksTitle").value = data.cards.yks.title || "YKS'ye Kalan";
        document.getElementById("yksDate").value = data.cards.yks.date || "";
      } else {
        // VarsayÄ±lan deÄŸerler
        document.getElementById("yksEnabled").checked = true;
        document.getElementById("yksTitle").value = "YKS'ye Kalan";
      }

      // DoÄŸum gÃ¼nÃ¼ verilerini yÃ¼kle
      if (data.cards.birthdays) {
        document.getElementById("birthdayEnabled").checked = data.cards.birthdays.enabled !== false; // Default true
        document.getElementById("bTitle").value = data.cards.birthdays.title || "Ä°yi ki doÄŸdun!";
      } else {
        // VarsayÄ±lan deÄŸerler
        document.getElementById("birthdayEnabled").checked = true;
        document.getElementById("bTitle").value = "Ä°yi ki doÄŸdun!";
      }
    }

    // Initialize info data on page load
    // initInfoData();

    // Load media center data after page loads
    document.addEventListener('DOMContentLoaded', async () => {
      // Initialize Firebase data first
      await initializeData();

      console.log('âœ… initializeData tamamlandÄ±, ÅŸimdi diÄŸer init fonksiyonlarÄ± Ã§aÄŸrÄ±lÄ±yor...');

      // Now initialize all components (data is ready)
      await initBirthdayData();
      await initDutyData();
      await initQuoteData();
      initInfoData();
      loadScheduleEntries();

      // Initialize timePlan entries
      if (data.cards.timePlan && data.cards.timePlan.items) {
        timePlanEntries = data.cards.timePlan.items;
      }

      // Set UI values
      if (data.cards.yks) {
        document.getElementById("yksDate").value = data.cards.yks.date || "";
      }

      if (data.cards.ticker) {
        document.getElementById("tText").value = data.cards.ticker.text || "";
        const tickerSpeed = data.cards.ticker.speed || 20;
        document.getElementById("tSpeed").value = tickerSpeed;
        document.getElementById("tSpeedLabel").textContent = tickerSpeed;
      }

      displayUserInfo(); // KullanÄ±cÄ± bilgilerini gÃ¶ster
      loadYKSAndBirthdayData();
      setTimeout(() => {
        loadMediaCenterData();
      }, 100);
    });

    // ===== FIREBASE MIGRATION FUNCTIONS =====

    /**
     * Migrate localStorage data to Firebase manually
     */
    async function migrateToFirebase() {
      const statusEl = document.getElementById('migrationStatusText');

      try {
        statusEl.textContent = 'â³ LocalStorage verileri okunuyor...';
        statusEl.className = 'text-blue-600 font-bold';

        // Read from localStorage
        const localData = localStorage.getItem('panoData');

        if (!localData) {
          statusEl.textContent = 'âŒ LocalStorage boÅŸ! AktarÄ±lacak veri yok.';
          statusEl.className = 'text-red-600 font-bold';
          alert('LocalStorage\'da veri bulunamadÄ±. Ã–nce admin panelden veri girmeniz gerekiyor.');
          return;
        }

        const parsedData = JSON.parse(localData);

        statusEl.textContent = 'ğŸš€ Firebase\'e aktarÄ±lÄ±yor...';
        statusEl.className = 'text-orange-600 font-bold';

        // Force save to Firebase
        const success = await FirebaseStorage.saveData(parsedData);

        if (success) {
          statusEl.textContent = 'âœ… BaÅŸarÄ±yla aktarÄ±ldÄ±! Firebase gÃ¼ncel.';
          statusEl.className = 'text-green-600 font-bold';
          alert('âœ… LocalStorage verileri baÅŸarÄ±yla Firebase\'e aktarÄ±ldÄ±!');
        } else {
          statusEl.textContent = 'âš ï¸ KÄ±smen baÅŸarÄ±lÄ± (LocalStorage\'a kaydedildi ama Firebase hatasÄ± olabilir)';
          statusEl.className = 'text-yellow-600 font-bold';
          alert('âš ï¸ Firebase\'e kaydetme sÄ±rasÄ±nda bir sorun oluÅŸtu, ancak veriler LocalStorage\'da gÃ¼vende.');
        }

      } catch (error) {
        console.error('Migration error:', error);
        statusEl.textContent = 'âŒ Hata: ' + error.message;
        statusEl.className = 'text-red-600 font-bold';
        alert('âŒ AktarÄ±m sÄ±rasÄ±nda bir hata oluÅŸtu: ' + error.message);
      }
    }

    /**
     * Check what data exists in Firebase
     */
    async function checkFirebaseData() {
      const statusEl = document.getElementById('migrationStatusText');

      try {
        statusEl.textContent = 'ğŸ” Firebase kontrol ediliyor...';
        statusEl.className = 'text-blue-600 font-bold';

        const snapshot = await firebase.database().ref('panoData').once('value');
        const firebaseData = snapshot.val();

        if (firebaseData) {
          const dataSize = JSON.stringify(firebaseData).length;
          const hasSchoolName = firebaseData.schoolName ? 'âœ…' : 'âŒ';
          const hasCards = firebaseData.cards ? 'âœ…' : 'âŒ';

          statusEl.textContent = `âœ… Firebase\'de veri var (${(dataSize / 1024).toFixed(2)} KB)`;
          statusEl.className = 'text-green-600 font-bold';

          alert(`ğŸ” Firebase Durum Raporu:\n\n` +
            `Okul AdÄ±: ${hasSchoolName} ${firebaseData.schoolName || 'Yok'}\n` +
            `Kartlar: ${hasCards}\n` +
            `Toplam Veri Boyutu: ${(dataSize / 1024).toFixed(2)} KB\n\n` +
            `Detaylar iÃ§in tarayÄ±cÄ± konsolunu kontrol edin.`);

          console.log('ğŸ“Š Firebase Data:', firebaseData);
        } else {
          statusEl.textContent = 'âš ï¸ Firebase boÅŸ! Veri aktarÄ±mÄ± gerekiyor.';
          statusEl.className = 'text-orange-600 font-bold';
          alert('âš ï¸ Firebase\'de henÃ¼z veri yok.\n\n"LocalStorage Verilerini Firebase\'e Aktar" butonuna tÄ±klayarak verilerinizi aktarabilirsiniz.');
        }

      } catch (error) {
        console.error('Firebase check error:', error);
        statusEl.textContent = 'âŒ Firebase baÄŸlantÄ± hatasÄ±: ' + error.message;
        statusEl.className = 'text-red-600 font-bold';
        alert('âŒ Firebase\'e baÄŸlanÄ±rken hata oluÅŸtu:\n' + error.message);
      }
    }

    // ===== BIRTHDAY DEBUG MODAL =====
    async function openBirthdayDebugModal() {
      const modal = document.getElementById('birthdayDebugModal');
      const content = document.getElementById('debugModalContent');
      const countEl = document.getElementById('debugStudentCount');

      modal.classList.remove('hidden');
      content.innerHTML = '<div class="text-center py-8"><span class="material-symbols-outlined text-6xl text-gray-300 animate-pulse">hourglass_top</span><p class="mt-4 text-gray-500">Firebase\'den veriler yÃ¼kleniyor...</p></div>';

      try {
        // DoÄŸrudan Firebase'den Ã§ek
        const snapshot = await firebase.database().ref('panoData/cards/birthdays').once('value');
        const birthdaysData = snapshot.val();

        console.log('ğŸ” Firebase Debug - Raw birthdaysData:', birthdaysData);
        console.log('ğŸ” Firebase Debug - Type:', typeof birthdaysData);

        if (!birthdaysData) {
          content.innerHTML = '<div class="text-center py-8 text-red-500"><span class="material-symbols-outlined text-6xl">error</span><p class="mt-4 font-bold">Firebase\'de birthdays verisi bulunamadÄ±!</p><p class="text-sm text-gray-500 mt-2">Path: panoData/cards/birthdays</p></div>';
          countEl.textContent = '0';
          return;
        }

        let students = birthdaysData.students;
        console.log('ğŸ” Firebase Debug - students:', students);
        console.log('ğŸ” Firebase Debug - students type:', typeof students);
        console.log('ğŸ” Firebase Debug - students isArray:', Array.isArray(students));

        if (!students) {
          content.innerHTML = '<div class="text-center py-8 text-orange-500"><span class="material-symbols-outlined text-6xl">warning</span><p class="mt-4 font-bold">students alanÄ± bulunamadÄ±!</p><p class="text-sm text-gray-500 mt-2">birthdays objesi var ama students yok</p><pre class="mt-4 p-4 bg-gray-100 rounded text-left text-xs overflow-auto max-h-60">' + JSON.stringify(birthdaysData, null, 2) + '</pre></div>';
          countEl.textContent = '0';
          return;
        }

        // Object ise array'e Ã§evir
        if (typeof students === 'object' && !Array.isArray(students)) {
          console.log('ğŸ” Firebase Debug - Converting object to array...');
          students = Object.values(students);
        }

        countEl.textContent = students.length;

        if (students.length === 0) {
          content.innerHTML = '<div class="text-center py-8 text-gray-500"><span class="material-symbols-outlined text-6xl">sentiment_dissatisfied</span><p class="mt-4">Ã–ÄŸrenci listesi boÅŸ!</p></div>';
          return;
        }

        // Ä°lk 20 Ã¶ÄŸrenciyi listele (performans iÃ§in)
        const displayStudents = students.slice(0, 20);
        let html = '<table class="w-full text-left text-sm"><thead><tr class="bg-slate-100"><th class="p-2">#</th><th class="p-2">Ad Soyad</th><th class="p-2">DoÄŸum Tarihi</th><th class="p-2">Cinsiyet</th></tr></thead><tbody>';

        displayStudents.forEach((student, i) => {
          html += `<tr class="border-b hover:bg-slate-50">
            <td class="p-2">${i + 1}</td>
            <td class="p-2 font-medium">${student.name || '-'} ${student.surname || ''}</td>
            <td class="p-2 font-mono text-xs">${student.birthdate || '-'}</td>
            <td class="p-2">${student.gender === 'K' ? 'ğŸ‘§' : 'ğŸ‘¦'}</td>
          </tr>`;
        });

        html += '</tbody></table>';

        if (students.length > 20) {
          html += `<p class="mt-4 text-center text-gray-500 text-sm">... ve ${students.length - 20} Ã¶ÄŸrenci daha (toplam: ${students.length})</p>`;
        }

        content.innerHTML = html;

      } catch (error) {
        console.error('ğŸ” Firebase Debug Error:', error);
        content.innerHTML = `<div class="text-center py-8 text-red-500"><span class="material-symbols-outlined text-6xl">error</span><p class="mt-4 font-bold">Hata: ${error.message}</p></div>`;
        countEl.textContent = 'Hata';
      }
    }

    function closeBirthdayDebugModal() {
      document.getElementById('birthdayDebugModal').classList.add('hidden');
    }
  </script>

  <!-- Birthday Debug Modal -->
  <div id="birthdayDebugModal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[80vh] overflow-hidden">
      <div class="bg-gradient-to-r from-orange-500 to-pink-500 text-white p-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <span class="material-symbols-outlined text-2xl">bug_report</span>
          <div>
            <h3 class="font-bold text-lg">Firebase Debug - DoÄŸum GÃ¼nleri</h3>
            <p class="text-sm opacity-90">Toplam Ã–ÄŸrenci: <span id="debugStudentCount" class="font-bold">-</span></p>
          </div>
        </div>
        <button onclick="closeBirthdayDebugModal()" class="p-2 hover:bg-white/20 rounded-lg transition-colors">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div id="debugModalContent" class="p-4 overflow-auto max-h-[60vh]">
        <!-- Ä°Ã§erik JS ile doldurulacak -->
      </div>
      <div class="p-4 border-t bg-slate-50 flex justify-end">
        <button onclick="closeBirthdayDebugModal()"
          class="px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-bold">
          Kapat
        </button>
      </div>
    </div>
  </div>

</body>

</html>